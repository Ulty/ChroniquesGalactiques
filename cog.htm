<!-- **** SCRIPTS / SHEET WORKERS -->
<script type="text/worker">
  function consoleLog(l, m) {
    m = m || '';
    if (m !== '') m = ' : ' + m;
    console.log('** CO sheetworker' + m + ' <<<');
    console.log(l);
    console.log('** CO sheetworker' + m + ' >>>');
  }
  
  // C# String.Format() emulation
  function stringFormat(s) {
    var s = arguments[0];
    for (a = 0; a < arguments.length - 1; a++) {
      s = s.replace(new RegExp('\\{' + a + '\\}' ,'g'), arguments[a+1]);
    }
    return s;
  }

  function importStatblock(text) {
    text = text.replace(/\r/g, '');
    text = text.replace(/ \(DM/g, ' DM');
    text = text.replace(/ \(RD/g, ' RD');
    text = text.replace(/\, /g, ' ');
    var npc = {};
    var rows = text.split(/\n/);
    console.log('** CO sheetworker : parsing text <<<');
    rows.forEach(function(row) {
      console.log(row);
      if (row.toUpperCase().indexOf('DM') != -1) { // this is an attack line
        row = row.replace(/\)$/g, ''); // handle CG statblocks
        if (!npc.Atks) npc.Atks = [];
        npc.Atks.push(row);
        return;
      }
      row = row.replace(/ \(/g, '('); // strip space before '(
      row = row.replace(/très /g, 'très~'); // handle 'très petite' size
      row = row.replace(/créature /g, 'PROFIL créature~'); // handle 'créature' mention
      var items = row.split(' ');
      for (var item = 0; item < items.length-1; item++) {
        if (item % 2 === 0) {
          var k = items[item].toUpperCase().replace(/\./g, '');
          var v = items[item + 1].replace(/~/g, ' ');
          if (v.charAt(v.length - 1) == ')' && v.charAt(0) != '(') v = v.substring(0, v.length - 1);
          npc[k] = v;
        }
      }
    });
    console.log('** CO sheetworker : parsing text >>>');
    return npc;
  }

  function processBaseAttributes(universe, pnjObj) {
    var result = '';
    var pnj_sagorper = '';
    var pnj_jetsagorper = '';
    var pnj_sagper = 'pnj_per';
    var pnj_jetsagper = 'pnj_jetper';
    var sagOrPer = pnjObj.PER; //might be undefined
    if (universe == 'COF') { // COF uses SAG (Wisdom)
      pnj_sagper = 'pnj_sag';
      pnj_jetsagper = 'pnj_jetsag';
      if (!pnjObj.hasOwnProperty('SAG') && pnjObj.hasOwnProperty('PER')) {
        // in case a CG/COC statblock is pasted to COF
        sagOrPer = pnjObj.PER;
        result = 'Attention : PER trouvé à la place de SAG';
      } else {
        sagOrPer = pnjObj.SAG;
      }
    }
    if (universe == 'COC' || universe == 'CG') { // CG & COC uses PER (Perception)
      pnj_sagper = 'pnj_per';
      pnj_jetsagper = 'pnj_jetper';
      if (!pnjObj.hasOwnProperty('PER') && pnjObj.hasOwnProperty('SAG')) {
        // in case a COF statblock is pasted to CG/COC
        sagOrPer = pnjObj.SAG;
        result = 'Attention : SAG trouvé à la place de PER';
      } else {
        sagOrPer = pnjObj.PER;
      }
    }
    var jnor = '1d20';
    var jsup = '2d20kh1';
    var pnjAttrs = {};
    pnjAttrs.NIVEAU = parseInt(pnjObj.NC) || 0;
    delete pnjObj.NC;
    pnjAttrs.TAILLE = pnjObj.TAILLE || '';
    delete pnjObj.TAILLE;
    if (pnjObj.hasOwnProperty('PROFIL')) pnjAttrs.PROFIL = pnjObj.PROFIL;
    delete pnjObj.PROFIL;
    pnjAttrs.pnj_for = parseInt(pnjObj.FOR.replace('*', ''));
    pnjAttrs.pnj_jetfor = pnjObj.FOR.charAt(pnjObj.FOR.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.FOR;
    pnjAttrs.pnj_dex = parseInt(pnjObj.DEX.replace('*', ''));
    pnjAttrs.pnj_jetdex = pnjObj.DEX.charAt(pnjObj.DEX.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.DEX;
    pnjAttrs.pnj_con = parseInt(pnjObj.CON.replace('*', ''));
    pnjAttrs.pnj_jetcon = pnjObj.CON.charAt(pnjObj.CON.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.CON;
    pnjAttrs.pnj_int = parseInt(pnjObj.INT.replace('*', ''));
    pnjAttrs.pnj_jetint = pnjObj.INT.charAt(pnjObj.INT.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.INT;
    pnjAttrs[pnj_sagper] = parseInt(sagOrPer.replace('*', ''));
    pnjAttrs[pnj_jetsagper] = sagOrPer.charAt(sagOrPer.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.SAG;
    delete pnjObj.PER;
    pnjAttrs.pnj_cha = parseInt(pnjObj.CHA.replace('*', ''));
    pnjAttrs.pnj_jetcha = pnjObj.CHA.charAt(pnjObj.CHA.length - 1) == '*' ? jsup : jnor;
    delete pnjObj.CHA;
    pnjAttrs.pnj_init = parseInt(pnjObj.INIT);
    delete pnjObj.INIT;
    pnjAttrs.pnj_def = parseInt(pnjObj.DEF);
    delete pnjObj.DEF;
    pnjAttrs.pnj_pv = parseInt(pnjObj.PV);
    pnjAttrs.pnj_pv_max = parseInt(pnjObj.PV);
    delete pnjObj.PV;
    consoleLog(pnjAttrs, 'setting attributes');
    pnjAttrs.statblock = '';
    setAttrs(pnjAttrs);
    return result;
  }

  function processAttacks(universe, pnjObj) {
    var result = '';
    for (var atk = 0; atk < pnjObj.Atks.length; atk++) {
      var atkItems = pnjObj.Atks[atk].split(' ');
      consoleLog(atkItems, 'attacks found');
      if (atkItems[atkItems.length - 1] == 'DM') atkItems.push('-');
      var atkAtt = '{{attaque=';
      var atkNom = '';
      var atkBonus = -1;
      var atkDM = '';
      var atkSpec = '';
      var parsed = '';
      for (var item = 0; item < atkItems.length; item++) {
        if (atkItems[item] == 'DM' && atkNom == '') {
          atkNom = parsed;
          parsed = 'DM';
          continue;
        }
        if (atkItems[item].charAt(0) == '+' && atkItems[item] != '+' && atkNom == '') {
          atkBonus = parseInt(atkItems[item].replace('+', '')) || 0;
          atkNom = parsed;
          parsed = '';
          continue;
        }
        if (parsed.endsWith('DM')) {
          atkDM = atkItems[item];
          atkSpec = parsed.replace('DM', '');
          parsed = '';
          continue;
        }
        parsed += parsed != '' ? ' ' : '';
        parsed += atkItems[item];
      }
      consoleLog(atkNom + ' ' + atkBonus + ' ' + atkDM + ' ' + atkSpec);
      if (atkBonus == -1) atkAtt = ''; // No attack bonus found, damage only
      var atkDmg = '{{degats=';
      var atkNbDe = 0;
      var atkDe = '';
      var atkBonusDM = 0;
      if (atkDM != '') {
        atkDM = atkDM.replace('d', '|');
        atkDM = atkDM.replace('+', '|+');
        atkDM = atkDM.replace('-', '|-');
        var dm = atkDM.split('|');
        atkNbDe = parseInt(dm[0]) || 0;
        if (atkNbDe == 0) atkDmg = ''; // No damage dice, attack only
        atkDe = dm[1];
        if (universe == 'COC') atkDe += '!';
        atkBonusDM = parseInt(dm[2]) || 0;
      }
      if (atkNom != '' && atkNbDe >= 0 && atkDe != '') {
        newRowID = generateRowID();
        var atkRow = {};
        atkRow['repeating_pnjatk_' + newRowID + '_atkatt'] = atkAtt;
        atkRow['repeating_pnjatk_' + newRowID + '_atknom'] = atkNom;
        atkRow['repeating_pnjatk_' + newRowID + '_atkjet'] = '1d20';
        atkRow['repeating_pnjatk_' + newRowID + '_atkbonus'] = atkBonus;
        atkRow['repeating_pnjatk_' + newRowID + '_atkdmg'] = atkDmg;
        atkRow['repeating_pnjatk_' + newRowID + '_atkdmnbde'] = atkNbDe;
        atkRow['repeating_pnjatk_' + newRowID + '_atkdmde'] = atkDe;
        atkRow['repeating_pnjatk_' + newRowID + '_atkdmbonus'] = atkBonusDM;
        atkSpec += parsed;
        atkSpec = atkSpec.replace(/\d+d\d+/g, '[[$&]]'); // search for <numbers>d<numbers> and replace with in-line roll
        if (atkSpec != '') atkRow['repeating_pnjatk_' + newRowID + '_atkspec'] = atkSpec;
        consoleLog(atkRow, 'adding attack');
        setAttrs(atkRow);
      } else {
        result = 'Err: impossible d\'analyser le contenu de "' + pnjObj.Atks[atk] + '"';
      }
    }
    return result;
  }
  
  on('sheet:opened', function() {
    // **** Gestion transition de version
    getAttrs(["VERSION"], function(values) {
      var verfdp = parseFloat(values.VERSION) || 0;
      if (verfdp === 0) {
        // Version 1.6 vers 1.7
        getAttrs(["FOR_SUP", "DEX_SUP", "CON_SUP", "INT_SUP", "PER_SUP", "CHA_SUP"], function(jets) {
          var sfor, sdex, scon, sint, sper, scha = "";
          if (jets.FOR_SUP == "2") {
            sfor = "@{JETSUP}";
          } else {
            sfor = "@{JETNORMAL}";
          }
          if (jets.DEX_SUP == "2") {
            sdex = "@{JETSUP}";
          } else {
            sdex = "@{JETNORMAL}";
          }
          if (jets.CON_SUP == "2") {
            scon = "@{JETSUP}";
          } else {
            scon = "@{JETNORMAL}";
          }
          if (jets.INT_SUP == "2") {
            sint = "@{JETSUP}";
          } else {
            sint = "@{JETNORMAL}";
          }
          if (jets.PER_SUP == "2") {
            sper = "@{JETSUP}";
          } else {
            sper = "@{JETNORMAL}";
          }
          if (jets.CHA_SUP == "2") {
            scha = "@{JETSUP}";
          } else {
            scha = "@{JETNORMAL}";
          }
          setAttrs({
            FOR_SUP: sfor,
            DEX_SUP: sdex,
            CON_SUP: scon,
            INT_SUP: sint,
            PER_SUP: sper,
            CHA_SUP: scha,
            VERSION: "2.0"
          });
        });
      }
      if (verfdp < 3) { // version 2.0 > 3.0
        getAttrs(['UNIVERS', 'FOR_BONUS', 'DEX_BONUS', 'CON_BONUS', 'INT_BONUS', 'PER_BONUS', 'CHA_BONUS', 'ATKCAC_DIV', 'ATKTIR_DIV', 'ATKMAG_DIV', 'ATKMEN_DIV', 'PSYINTUI_DIV', 'PSYINFLU_DIV', 'INIT_DIV', 'DEFDIV', 'DEPDIV'], function(values) {
          var for_bonus_desc = '',
            for_bonus = parseInt(values.FOR_BONUS) || 0;
          if (for_bonus !== 0) for_bonus_desc = 'Bonus FOR';
          var dex_bonus_desc = '',
            dex_bonus = parseInt(values.DEX_BONUS) || 0;
          if (dex_bonus !== 0) dex_bonus_desc = 'Bonus DEX';
          var con_bonus_desc = '',
            con_bonus = parseInt(values.CON_BONUS) || 0;
          if (con_bonus !== 0) con_bonus_desc = 'Bonus CON';
          var int_bonus_desc = '',
            int_bonus = parseInt(values.INT_BONUS) || 0;
          if (int_bonus !== 0) int_bonus_desc = 'Bonus INT';
          var per_bonus_desc = '',
            per_bonus = parseInt(values.PER_BONUS) || 0;
          if (per_bonus !== 0) per_bonus_desc = 'Bonus PER';
          var cha_bonus_desc = '',
            cha_bonus = parseInt(values.CHA_BONUS) || 0;
          if (cha_bonus !== 0) cha_bonus_desc = 'Bonus CHA';
          var atkcac_bonus_desc = '',
            atkcac_div = parseInt(values.ATKCAC_DIV) || 0;
          if (atkcac_div !== 0) atkcac_bonus_desc = 'Bonus ATC';
          var atktir_bonus_desc = '',
            atktir_div = parseInt(values.ATKTIR_DIV) || 0;
          if (atktir_div !== 0) atktir_bonus_desc = 'Bonus ATD';
          var atkmag_bonus_desc = '',
            atkmag_div = parseInt(values.ATKMAG_DIV) || 0;
          if (atkmag_div !== 0) atkmag_bonus_desc = 'Bonus MAG';
          var atkmen_bonus_desc = '',
            atkmen_div = parseInt(values.ATKMEN_DIV) || 0;
          if (atkmen_div !== 0) atkmen_bonus_desc = 'Bonus MEN';
          var psyinflu_bonus_desc = '',
            psyinflu_div = parseInt(values.ATKPSYINFLU_DIV) || 0;
          if (psyinflu_div !== 0) psyinflu_bonus_desc = 'Bonus Psy Inf.';
          var psyintui_bonus_desc = '',
            psyintui_div = parseInt(values.ATKPSYINTUI_DIV) || 0;
          if (psyintui_div !== 0) psyintui_bonus_desc = 'Bonus Psy Int.';
          var init_bonus_desc = '',
            init_div = parseInt(values.INIT_DIV) || 0;
          if (init_div !== 0) init_bonus_desc = 'Bonus Init.';
          var def_bonus_desc = '',
            defdiv = parseInt(values.DEFDIV) || 0;
          if (defdiv !== 0) def_bonus_desc = 'Bonus DEF';
          var dep_bonus_desc = '',
            depdiv = parseInt(values.DEPDIV) || 0;
          if (depdiv !== 0) dep_bonus_desc = 'Bonus DEP';
          setAttrs({
            FOR_BUFF1_DESC: for_bonus_desc,
            FOR_BUFF1: for_bonus,
            FOR_BUFF: for_bonus,
            DEX_BUFF1_DESC: dex_bonus_desc,
            DEX_BUFF1: dex_bonus,
            DEX_BUFF: dex_bonus,
            CON_BUFF1_DESC: con_bonus_desc,
            CON_BUFF1: con_bonus,
            CON_BUFF: con_bonus,
            INT_BUFF1_DESC: int_bonus_desc,
            INT_BUFF1: int_bonus,
            INT_BUFF: int_bonus,
            PER_BUFF1_DESC: per_bonus_desc,
            PER_BUFF1: per_bonus,
            PER_BUFF: per_bonus,
            CHA_BUFF1_DESC: cha_bonus_desc,
            CHA_BUFF1: cha_bonus,
            CHA_BUFF: cha_bonus,
            ATKCAC_BUFF1_DESC: atkcac_bonus_desc,
            ATKCAC_BUFF1: atkcac_div,
            ATKCAC_BUFF: atkcac_div,
            ATKTIR_BUFF1_DESC: atktir_bonus_desc,
            ATKTIR_BUFF1: atktir_div,
            ATKTIR_BUFF: atktir_div,
            ATKMAG_BUFF1_DESC: atkmag_bonus_desc,
            ATKMAG_BUFF1: atkmag_div,
            ATKMAG_BUFF: atkmag_div,
            ATKMEN_BUFF1_DESC: atkmen_bonus_desc,
            ATKMEN_BUFF1: atkmen_div,
            ATKMEN_BUFF: atkmen_div,
            PSYINFLU_BUFF1_DESC: psyinflu_bonus_desc,
            PSYINFLU_BUFF1: psyinflu_div,
            PSYINFLU_BUFF: psyinflu_div,
            PSYINTUI_BUFF1_DESC: psyintui_bonus_desc,
            PSYINTUI_BUFF1: psyintui_div,
            PSYINTUI_BUFF: psyintui_div,
            INIT_BUFF1_DESC: init_bonus_desc,
            INIT_BUFF1: init_div,
            INIT_BUFF: init_div,
            DEF_BUFF1_DESC: def_bonus_desc,
            DEF_BUFF1: defdiv,
            DEF_BUFF: defdiv,
            DEP_BUFF1_DESC: dep_bonus_desc,
            DEP_BUFF1: depdiv,
            DEP_BUFF: depdiv,
            ATKTIRV_BUFF: 0,
            VERSION: '3.0'
          });
        });
      }
      if (verfdp < 3.4) { // version 3.3 > 3.4
        getAttrs(['TRAITS'], function(values) {
          var traits = values.TRAITS.split(':');
          if (traits.length >= 2) {
            newRowID = generateRowID();
            var traitRow = {};
            traitRow['repeating_traits_' + newRowID + '_traitnom'] = traits[0].trim();
            traitRow['repeating_traits_' + newRowID + '_traittype'] = 'Race / Humain';
            traits.splice(0,1);
            traitRow['repeating_traits_' + newRowID + '_traitdesc'] = traits.join(':').trim();
            setAttrs(traitRow);
            setAttrs({ VERSION: '3.4' });
          }
        });
      }
    });
    // Activer Buffs PSY ou de vaisseau
    getAttrs(['UNIVERS', 'type_personnage', 'PE_ONCE', 'FOR_BUFF1_DESC', 'DEX_BUFF1_DESC', 'INT_BUFF1_DESC', 'PER_BUFF1_DESC', 'CHA_BUFF1_DESC', 'ATKTIRV_BUFF1_DESC', 'INIT_BUFF1_DESC', 'DEFVPIL_BUFF1_DESC', 'DEFVPIL_BUFF2_DESC', 'DEFVSEN_BUFF1_DESC', 'DEFVSEN_BUFF2_DESC'], function(values) {
      if (values.UNIVERS == 'CG') {
        if (values.type_personnage == 'pj') {
          setAttrs({
            voir_psy: '1'
          });
        } else if (values.type_personnage == 'vaisseau' && values.PE_ONCE !== '') {
          var for_buff_desc = (values.FOR_BUFF1_DESC) || values.PE_ONCE;
          var dex_buff_desc = (values.DEX_BUFF1_DESC) || values.PE_ONCE;
          var int_buff_desc = (values.INT_BUFF1_DESC) || values.PE_ONCE;
          var per_buff_desc = (values.PER_BUFF1_DESC) || values.PE_ONCE;
          var cha_buff_desc = (values.CHA_BUFF1_DESC) || values.PE_ONCE;
          var atktirv_buff_desc = (values.ATKTIRV_BUFF1_DESC) || values.PE_ONCE;
          var init_buff_desc = (values.INIT_BUFF1_DESC) || 'Valeur DEX pilote';
          var defvpil_buff1_desc = (values.DEFVPIL_BUFF1_DESC) || 'Mod. DEX Pilote';
          var defvpil_buff2_desc = (values.DEFVPIL_BUFF2_DESC) || 'Rang Pilotage';
          var defvsen_buff1_desc = (values.DEFVSEN_BUFF1_DESC) || 'Mod. INT Scantech';
          var defvsen_buff2_desc = (values.DEFVSEN_BUFF2_DESC) || 'Rang Electronique';
          setAttrs({
            FOR_BUFF1_DESC: for_buff_desc,
            DEX_BUFF1_DESC: dex_buff_desc,
            INT_BUFF1_DESC: int_buff_desc,
            PER_BUFF1_DESC: per_buff_desc,
            CHA_BUFF1_DESC: cha_buff_desc,
            ATKTIRV_BUFF1_DESC: atktirv_buff_desc,
            INIT_BUFF1_DESC: init_buff_desc,
            DEFVPIL_BUFF1_DESC: defvpil_buff1_desc,
            DEFVPIL_BUFF2_DESC: defvpil_buff2_desc,
            DEFVSEN_BUFF1_DESC: defvsen_buff1_desc,
            DEFVSEN_BUFF2_DESC: defvsen_buff2_desc,
            PE_ONCE: '',
            type_personnage: 'vaisseau'
          });
        }
      }
    });
    // MAJ Version
    getAttrs(['verfdp'], function(values) {
      setAttrs({
        VERSION: values.verfdp
      });
    });
    // LAST_PV
    getAttrs(['PV'], function(values) {
      setAttrs({ LAST_PV: values.PV })
    });
  });

  on('change:character_name', function(eventInfo) {
    getAttrs(['character_name'], function(values) {
      var charName = values.character_name;
      charName = charName.replace(/ "/g, ' «');
      charName = charName.replace(/" /g, '» ');
      setAttrs({ character_name: charName })
    });
  });

  on('change:dex_buff1 change:dex_buff2 change:dex_buff3 change:dex_buff4 change:dex_buff5', function(eventInfo) {
    getAttrs(['DEX_BUFF1', 'DEX_BUFF2', 'DEX_BUFF3', 'DEX_BUFF4', 'DEX_BUFF5'], function(values) {
      var buff1 = parseInt(values.DEX_BUFF1) || 0;
      var buff2 = parseInt(values.DEX_BUFF2) || 0;
      var buff3 = parseInt(values.DEX_BUFF3) || 0;
      var buff4 = parseInt(values.DEX_BUFF4) || 0;
      var buff5 = parseInt(values.DEX_BUFF5) || 0;
      setAttrs({
        DEX_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:con_buff1 change:con_buff2 change:con_buff3 change:con_buff4 change:con_buff5', function(eventInfo) {
    getAttrs(['CON_BUFF1', 'CON_BUFF2', 'CON_BUFF3', 'CON_BUFF4', 'CON_BUFF5'], function(values) {
      var buff1 = parseInt(values.CON_BUFF1) || 0;
      var buff2 = parseInt(values.CON_BUFF2) || 0;
      var buff3 = parseInt(values.CON_BUFF3) || 0;
      var buff4 = parseInt(values.CON_BUFF4) || 0;
      var buff5 = parseInt(values.CON_BUFF5) || 0;
      setAttrs({
        CON_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:int_buff1 change:int_buff2 change:int_buff3 change:int_buff4 change:int_buff5', function(eventInfo) {
    getAttrs(['INT_BUFF1', 'INT_BUFF2', 'INT_BUFF3', 'INT_BUFF4', 'INT_BUFF5'], function(values) {
      var buff1 = parseInt(values.INT_BUFF1) || 0;
      var buff2 = parseInt(values.INT_BUFF2) || 0;
      var buff3 = parseInt(values.INT_BUFF3) || 0;
      var buff4 = parseInt(values.INT_BUFF4) || 0;
      var buff5 = parseInt(values.INT_BUFF5) || 0;
      setAttrs({
        INT_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:per_buff1 change:per_buff2 change:per_buff3 change:per_buff4 change:per_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'PER_BUFF1', 'PER_BUFF2', 'PER_BUFF3', 'PER_BUFF4', 'PER_BUFF5'], function(values) {
      if (values.UNIVERS != 'COF') {
        var buff1 = parseInt(values.PER_BUFF1) || 0;
        var buff2 = parseInt(values.PER_BUFF2) || 0;
        var buff3 = parseInt(values.PER_BUFF3) || 0;
        var buff4 = parseInt(values.PER_BUFF4) || 0;
        var buff5 = parseInt(values.PER_BUFF5) || 0;
        setAttrs({
          PER_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:cha_buff1 change:cha_buff2 change:cha_buff3 change:cha_buff4 change:cha_buff5', function(eventInfo) {
    getAttrs(['CHA_BUFF1', 'CHA_BUFF2', 'CHA_BUFF3', 'CHA_BUFF4', 'CHA_BUFF5'], function(values) {
      var buff1 = parseInt(values.CHA_BUFF1) || 0;
      var buff2 = parseInt(values.CHA_BUFF2) || 0;
      var buff3 = parseInt(values.CHA_BUFF3) || 0;
      var buff4 = parseInt(values.CHA_BUFF4) || 0;
      var buff5 = parseInt(values.CHA_BUFF5) || 0;
      setAttrs({
        CHA_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:atkcac_buff1 change:atkcac_buff2 change:atkcac_buff3 change:atkcac_buff4 change:atkcac_buff5', function(eventInfo) {
    getAttrs(['ATKCAC_BUFF1', 'ATKCAC_BUFF2', 'ATKCAC_BUFF3', 'ATKCAC_BUFF4', 'ATKCAC_BUFF5'], function(values) {
      var buff1 = parseInt(values.ATKCAC_BUFF1) || 0;
      var buff2 = parseInt(values.ATKCAC_BUFF2) || 0;
      var buff3 = parseInt(values.ATKCAC_BUFF3) || 0;
      var buff4 = parseInt(values.ATKCAC_BUFF4) || 0;
      var buff5 = parseInt(values.ATKCAC_BUFF5) || 0;
      setAttrs({
        ATKCAC_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:atktir_buff1 change:atktir_buff2 change:atktir_buff3 change:atktir_buff4 change:atktir_buff5', function(eventInfo) {
    getAttrs(['ATKTIR_BUFF1', 'ATKTIR_BUFF2', 'ATKTIR_BUFF3', 'ATKTIR_BUFF4', 'ATKTIR_BUFF5'], function(values) {
      var buff1 = parseInt(values.ATKTIR_BUFF1) || 0;
      var buff2 = parseInt(values.ATKTIR_BUFF2) || 0;
      var buff3 = parseInt(values.ATKTIR_BUFF3) || 0;
      var buff4 = parseInt(values.ATKTIR_BUFF4) || 0;
      var buff5 = parseInt(values.ATKTIR_BUFF5) || 0;
      setAttrs({
        ATKTIR_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:atkmag_buff1 change:atkmag_buff2 change:atkmag_buff3 change:atkmag_buff4 change:atkmag_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'ATKMAG_BUFF1', 'ATKMAG_BUFF2', 'ATKMAG_BUFF3', 'ATKMAG_BUFF4', 'ATKMAG_BUFF5'], function(values) {
      if (values.UNIVERS != 'CG') {
        var buff1 = parseInt(values.ATKMAG_BUFF1) || 0;
        var buff2 = parseInt(values.ATKMAG_BUFF2) || 0;
        var buff3 = parseInt(values.ATKMAG_BUFF3) || 0;
        var buff4 = parseInt(values.ATKMAG_BUFF4) || 0;
        var buff5 = parseInt(values.ATKMAG_BUFF5) || 0;
        setAttrs({
          ATKMAG_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:atkmen_buff1 change:atkmen_buff2 change:atkmen_buff3 change:atkmen_buff4 change:atkmen_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'ATKMEN_BUFF1', 'ATKMEN_BUFF2', 'ATKMEN_BUFF3', 'ATKMEN_BUFF4', 'ATKMEN_BUFF5'], function(values) {
      if (values.UNIVERS != 'COF') {
        var buff1 = parseInt(values.ATKMEN_BUFF1) || 0;
        var buff2 = parseInt(values.ATKMEN_BUFF2) || 0;
        var buff3 = parseInt(values.ATKMEN_BUFF3) || 0;
        var buff4 = parseInt(values.ATKMEN_BUFF4) || 0;
        var buff5 = parseInt(values.ATKMEN_BUFF5) || 0;
        setAttrs({
          ATKMEN_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:psyinflu_buff1 change:psyinflu_buff2 change:psyinflu_buff3 change:psyinflu_buff4 change:psyinflu_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'PSYINFLU_BUFF1', 'PSYINFLU_BUFF2', 'PSYINFLU_BUFF3', 'PSYINFLU_BUFF4', 'PSYINFLU_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.PSYINFLU_BUFF1) || 0;
        var buff2 = parseInt(values.PSYINFLU_BUFF2) || 0;
        var buff3 = parseInt(values.PSYINFLU_BUFF3) || 0;
        var buff4 = parseInt(values.PSYINFLU_BUFF4) || 0;
        var buff5 = parseInt(values.PSYINFLU_BUFF5) || 0;
        setAttrs({
          PSYINFLU_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:psyintui_buff1 change:psyintui_buff2 change:psyintui_buff3 change:psyintui_buff4 change:psyintui_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'PSYINTUI_BUFF1', 'PSYINTUI_BUFF2', 'PSYINTUI_BUFF3', 'PSYINTUI_BUFF4', 'PSYINTUI_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.PSYINTUI_BUFF1) || 0;
        var buff2 = parseInt(values.PSYINTUI_BUFF2) || 0;
        var buff3 = parseInt(values.PSYINTUI_BUFF3) || 0;
        var buff4 = parseInt(values.PSYINTUI_BUFF4) || 0;
        var buff5 = parseInt(values.PSYINTUI_BUFF5) || 0;
        setAttrs({
          PSYINTUI_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:init_buff1 change:init_buff2 change:init_buff3 change:init_buff4 change:init_buff5', function(eventInfo) {
    getAttrs(['INIT_BUFF1', 'INIT_BUFF2', 'INIT_BUFF3', 'INIT_BUFF4', 'INIT_BUFF5'], function(values) {
      var buff1 = parseInt(values.INIT_BUFF1) || 0;
      var buff2 = parseInt(values.INIT_BUFF2) || 0;
      var buff3 = parseInt(values.INIT_BUFF3) || 0;
      var buff4 = parseInt(values.INIT_BUFF4) || 0;
      var buff5 = parseInt(values.INIT_BUFF5) || 0;
      setAttrs({
        INIT_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:def_buff1 change:def_buff2 change:def_buff3 change:def_buff4 change:def_buff5', function(eventInfo) {
    getAttrs(['DEF_BUFF1', 'DEF_BUFF2', 'DEF_BUFF3', 'DEF_BUFF4', 'DEF_BUFF5'], function(values) {
      var buff1 = parseInt(values.DEF_BUFF1) || 0;
      var buff2 = parseInt(values.DEF_BUFF2) || 0;
      var buff3 = parseInt(values.DEF_BUFF3) || 0;
      var buff4 = parseInt(values.DEF_BUFF4) || 0;
      var buff5 = parseInt(values.DEF_BUFF5) || 0;
      setAttrs({
        DEF_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
      });
    });
  });

  on('change:dep_buff1 change:dep_buff2 change:dep_buff3 change:dep_buff4 change:dep_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'DEP_BUFF1', 'DEP_BUFF2', 'DEP_BUFF3', 'DEP_BUFF4', 'DEP_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.DEP_BUFF1) || 0;
        var buff2 = parseInt(values.DEP_BUFF2) || 0;
        var buff3 = parseInt(values.DEP_BUFF3) || 0;
        var buff4 = parseInt(values.DEP_BUFF4) || 0;
        var buff5 = parseInt(values.DEP_BUFF5) || 0;
        setAttrs({
          DEP_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:atktirv_buff1 change:atktirv_buff2 change:atktirv_buff3 change:atktirv_buff4 change:atktirv_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'ATKTIRV_BUFF1', 'ATKTIRV_BUFF2', 'ATKTIRV_BUFF3', 'ATKTIRV_BUFF4', 'ATKTIRV_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.ATKTIRV_BUFF1) || 0;
        var buff2 = parseInt(values.ATKTIRV_BUFF2) || 0;
        var buff3 = parseInt(values.ATKTIRV_BUFF3) || 0;
        var buff4 = parseInt(values.ATKTIRV_BUFF4) || 0;
        var buff5 = parseInt(values.ATKTIRV_BUFF5) || 0;
        setAttrs({
          ATKTIRV_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:defvpil_buff1 change:defvpil_buff2 change:defvpil_buff3 change:defvpil_buff4 change:defvpil_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'DEFVPIL_BUFF1', 'DEFVPIL_BUFF2', 'DEFVPIL_BUFF3', 'DEFVPIL_BUFF4', 'DEFVPIL_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.DEFVPIL_BUFF1) || 0;
        var buff2 = parseInt(values.DEFVPIL_BUFF2) || 0;
        var buff3 = parseInt(values.DEFVPIL_BUFF3) || 0;
        var buff4 = parseInt(values.DEFVPIL_BUFF4) || 0;
        var buff5 = parseInt(values.DEFVPIL_BUFF5) || 0;
        setAttrs({
          DEFVPIL_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:defvsen_buff1 change:defvsen_buff2 change:defvsen_buff3 change:defvsen_buff4 change:defvsen_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'DEFVSEN_BUFF1', 'DEFVSEN_BUFF2', 'DEFVSEN_BUFF3', 'DEFVSEN_BUFF4', 'DEFVSEN_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.DEFVSEN_BUFF1) || 0;
        var buff2 = parseInt(values.DEFVSEN_BUFF2) || 0;
        var buff3 = parseInt(values.DEFVSEN_BUFF3) || 0;
        var buff4 = parseInt(values.DEFVSEN_BUFF4) || 0;
        var buff5 = parseInt(values.DEFVSEN_BUFF5) || 0;
        setAttrs({
          DEFVSEN_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:pev_buff1 change:pev_buff2 change:pev_buff3 change:pev_buff4 change:pev_buff5', function(eventInfo) {
    getAttrs(['UNIVERS', 'PEV_BUFF1', 'PEV_BUFF2', 'PEV_BUFF3', 'PEV_BUFF4', 'PEV_BUFF5'], function(values) {
      if (values.UNIVERS == 'CG') {
        var buff1 = parseInt(values.PEV_BUFF1) || 0;
        var buff2 = parseInt(values.PEV_BUFF2) || 0;
        var buff3 = parseInt(values.PEV_BUFF3) || 0;
        var buff4 = parseInt(values.PEV_BUFF4) || 0;
        var buff5 = parseInt(values.PEV_BUFF5) || 0;
        setAttrs({
          PEV_BUFF: buff1 + buff2 + buff3 + buff4 + buff5
        });
      }
    });
  });

  on('change:condition', function(eventInfo) {
    getAttrs(['PCONDITION', 'CONDITION', 'ATKCAC_BUFF', 'ATKTIR_BUFF', 'INIT_BUFF', 'DEF_BUFF', 'ETATDE'], function(values) {
      // check prior condition for debuffs
      var pinit = 0;
      var patc = 0;
      var patd = 0;
      var pdef = 0;
      var etatde = values.ETATDE;
      switch (values.PCONDITION) {
        case 'A':
          pinit = 5;
          patc = 5;
          pdef = 5;
          patd = 10;
          break;
        case 'E':
          pdef = 5;
          break;
        case 'I':
          etatde = '20';
          break;
        case 'R':
          patc = 5;
          patd = 5;
          pdef = 5;
          break;
        case 'S':
          pdef = 5;
          break;
        case '':
          break;
      }
      // check condition for buffs
      var minit = 0;
      var matc = 0;
      var matd = 0;
      var mdef = 0;
      switch (values.CONDITION) {
        case 'A':
          minit = 5;
          matc = 5;
          mdef = 5;
          matd = 10;
          break;
        case 'E':
          mdef = 5;
          break;
        case 'I':
          etatde = '12';
          break;
        case 'R':
          matc = 5;
          matd = 5;
          mdef = 5;
          break;
        case 'S':
          mdef = 5;
          break;
        case '':
          etatde = '20';
          break;
      }
      // Now update all buffs and prior condition
      setAttrs({
        ATKCAC_BUFF: values.ATKCAC_BUFF + patc - matc,
        ATKTIR_BUFF: values.ATKTIR_BUFF + patd - matd,
        INIT_BUFF: values.INIT_BUFF + pinit - minit,
        DEF_BUFF: values.DEF_BUFF + pdef - mdef,
        ETATDE: etatde,
        PCONDITION: values.CONDITION
      });
    });
  });

  on('change:blessure', function(eventInfo) {
    getAttrs(['BLESSURE'], function(values) {
      var etatde = (values.BLESSURE == '1') ? '12' : '20';
      setAttrs({
        ETATDE: etatde
      });
    });
  });

  on('change:poisse', function(eventInfo) {
    getAttrs(['POISSE'], function(values) {
      var jetn = (values.POISSE == '1') ? '2d@{ETATDE}kl1' : '1d@{ETATDE}';
      var jets = (values.POISSE == '1') ? '1d@{ETATDE}' : '2d@{ETATDE}kh1';
      var jetsh = (values.POISSE == '1') ? '2d@{ETATDE}kh1' : '{2d@{ETATDE}kh1, 0d20+10}kh1';
      var jetr = (values.POISSE == '1') ? '2d12kl1' : '1d12';
      setAttrs({
        JETNORMAL: jetn,
        JETSUP: jets,
        JETSUPHERO: jetsh,
        JETRISQUE: jetr
      });
    });
  });

  on('change:statblock', function(eventInfo) {
    if (eventInfo.newValue === '') return;
    getAttrs(['UNIVERS', 'statblock'], function(values) {
      var messages = '';
      var pnjObj = importStatblock(values.statblock);
      if (pnjObj) {
        consoleLog(pnjObj, 'NPC object');
        messages = processBaseAttributes(values.UNIVERS, pnjObj);
        if (pnjObj.hasOwnProperty('Atks')) {
          var result = processAttacks(values.UNIVERS, pnjObj);
          if (result !== '' && messages !== '') result = '\n' + result;
          messages += result;
          delete pnjObj.Atks;
        }
        // Other attributes go to DIVERS field
        var divers = '';
        var otherAttrs = Object.keys(pnjObj);
        consoleLog(otherAttrs, 'additional data');
        if (otherAttrs.length > 0) {
          for (var other = 0; other < otherAttrs.length; other++) {
            var k = otherAttrs[other];
            divers += k + ' ' + pnjObj[k] + '\n';
          }
        }
        setAttrs({
          pnj_divers: divers,
          sbresult: messages
        });
      }
    });
  });

  on('change:type_personnage', function(eventInfo) {
    getAttrs(['type_personnage'], function(values) {
      setAttrs({type_fiche: values.type_personnage});
    });
  });
  
  on('change:pv', function(eventInfo) {
    getAttrs(['PV', 'PV_max', 'LAST_PV', 'SEUILBG', 'BLESSURE'], function(values) {
      var seuilbg = parseInt(values.SEUILBG) || 0;
      var max_pv = parseInt(values.PV_max) || 0;
      var last_pv = parseInt(values.LAST_PV) || max_pv;
      var curr_pv = parseInt(values.PV) || 0;
      var blessure = values.BLESSURE;
      if (seuilbg > 0) {
        if (last_pv - curr_pv >= seuilbg || curr_pv === 0) blessure = '1';
      }
      setAttrs({
        LAST_PV: values.PV,
        BLESSURE: blessure
      });
    });
  });

  on('change:poste_pil_nom change:poste_pil_bonus', function(eventInfo) {
    getAttrs(['POSTE_PIL_NOM', 'POSTE_PIL_BONUS'], function(values) {
      var poste_nom = values.POSTE_PIL_NOM || '';
      poste_nom = poste_nom != '' ? stringFormat('@{{0}|DEX}', poste_nom) : '0'
      var poste_bonus = parseInt(values.POSTE_PIL_BONUS) || 0;
      var poste = stringFormat('[[{0}]][DEX pilote] + {1}[Pilotage]', poste_nom, poste_bonus);
      setAttrs({ POSTE_PIL: poste });
    });
  });

  on('change:poste_mot_nom change:poste_mot_bonus', function(eventInfo) {
    getAttrs(['POSTE_MOT_NOM', 'POSTE_MOT_BONUS'], function(values) {
      var poste_nom = values.POSTE_MOT_NOM || '';
      poste_nom = poste_nom != '' ? stringFormat('@{{0}|INT}', poste_nom) : '0'
      var poste_bonus = parseInt(values.POSTE_MOT_BONUS) || 0;
      var poste = stringFormat('[[{0}]][INT mécano] + {1}[Moteurs]', poste_nom, poste_bonus);
      setAttrs({ POSTE_MOT: poste });
    });
  });

  on('change:poste_sen_nom change:poste_sen_bonus', function(eventInfo) {
    getAttrs(['POSTE_SEN_NOM', 'POSTE_SEN_BONUS'], function(values) {
      var poste_nom = values.POSTE_SEN_NOM || '';
      poste_nom = poste_nom != '' ? stringFormat('@{{0}|INT}', poste_nom) : '0'
      var poste_bonus = parseInt(values.POSTE_SEN_BONUS) || 0;
      var poste = stringFormat('[[{0}]][INT scan] + {1}[Electronique/Investigation]', poste_nom, poste_bonus);
      setAttrs({ POSTE_SEN: poste });
    });
  });

  on('change:poste_ord_nom change:poste_ord_bonus', function(eventInfo) {
    getAttrs(['POSTE_ORD_NOM', 'POSTE_ORD_BONUS'], function(values) {
      var poste_nom = values.POSTE_ORD_NOM || '';
      poste_nom = poste_nom != '' ? stringFormat('@{{0}|INT}', poste_nom) : '0'
      var poste_bonus = parseInt(values.POSTE_ORD_BONUS) || 0;
      var poste = stringFormat('[[{0}]][INT info] + {1}[Electronique]', poste_nom, poste_bonus);
      setAttrs({ POSTE_ORD: poste });
    });
  });
  
  on('change:repeating_armesv:armecan_nom change:repeating_armesv:armecan_bonus', function(eventInfo) {
    getAttrs(['repeating_armesv_armecan_nom', 'repeating_armesv_armecan_bonus'], function(values) {
      var poste_nom = values.repeating_armesv_armecan_nom || '';
      poste_nom = poste_nom != '' ? stringFormat('@{{0}|DEX}', poste_nom) : '0'
      var poste_bonus = parseInt(values.repeating_armesv_armecan_bonus) || 0;
      var poste = stringFormat('[[{0}]][DEX canonnier] + {1}[Armes lourdes]', poste_nom, poste_bonus);
      setAttrs({ repeating_armesv_armecan: poste });
    });
  });

</script>
<div class="sheet-mainBg">
  <!-- FDP -->
  <!-- INPUT HIDDEN Version FdP -->
  <input type="hidden" name="attr_verfdp" value="3.4" />
  <input type="hidden" name="attr_VERSION" value="3.4" />
  <!-- INPUT HIDDEN Univers (COF, CG, COC) -->
  <input type="hidden" name="attr_UNIVERS" value="CG" />
  <!-- INPUT HIDDEN Type de jets -->
  <input type="hidden" name="attr_JETNORMAL" value="1d@{ETATDE}" />
  <input type="hidden" name="attr_JETSUP" value="2d@{ETATDE}kh1" />
  <input type="hidden" name="attr_JETSUPHERO" value="{2d@{ETATDE}kh1, 0d20+10}kh1" />
  <input type="hidden" name="attr_JETRISQUE" value="1d12" />
  <!-- INPUT HIDDEN Buffs -->
  <input type="hidden" name="attr_FOR_BUFF" value="0" />
  <input type="hidden" name="attr_DEX_BUFF" value="0" />
  <input type="hidden" name="attr_CON_BUFF" value="0" />
  <input type="hidden" name="attr_INT_BUFF" value="0" />
  <input type="hidden" name="attr_SAG_BUFF" value="0" />
  <input type="hidden" name="attr_PER_BUFF" value="0" />
  <input type="hidden" name="attr_CHA_BUFF" value="0" />
  <input type="hidden" name="attr_ATKCAC_BUFF" value="0" />
  <input type="hidden" name="attr_ATKTIR_BUFF" value="0" />
  <input type="hidden" name="attr_ATKMAG_BUFF" value="0" />
  <input type="hidden" name="attr_ATKMEN_BUFF" value="0" />
  <input type="hidden" name="attr_PSYINTUI_BUFF" value="0" />
  <input type="hidden" name="attr_PSYINFLU_BUFF" value="0" />
  <input type="hidden" name="attr_INIT_BUFF" value="0" />
  <input type="hidden" name="attr_DEF_BUFF" value="0" />
  <input type="hidden" name="attr_DEP_BUFF" value="0" />
  <!-- INPUT HIDDEN Buffs vaisseau -->
  <input type="hidden" name="attr_ATKTIRV_BUFF" value="0" />
  <input type="hidden" name="attr_DEFVPIL_BUFF" value="0" />
  <input type="hidden" name="attr_DEFVSEN_BUFF" value="0" />
  <input type="hidden" name="attr_PEV_BUFF" value="0" />
  <!-- INPUT HIDDEN Etats préjudiciable précédent -->
  <input type="hidden" name="attr_PCONDITION" value="" />
  <!-- INPUT HIDDEN PE -->
  <input type="hidden" name="attr_PE_ONCE" value="Points énergie" />
  <!-- INPUT HIDDEN Précédent nombre de PV -->
  <input type="hidden" name="attr_LAST_PV" value="" />
  <!-- INPUT HIDDEN Choix carac jets capacités -->
  <input type="hidden" name="attr_QRYMOD" value="?{Carac. ?|Force,@{FOR}|Dextérité,@{DEX}|Constitution,@{CON}|Intelligence,@{INT}|Perception,@{PER}|Charisme,@{CHA}}" />
  <input type="hidden" name="attr_QRYMODT" value="?{Carac. ?|Force,@{FOR_TEST}|Dextérité,@{DEX_TEST}|Constitution,@{CON_TEST}|Intelligence,@{INT_TEST}|Perception,@{PER_TEST}|Charisme,@{CHA_TEST}}" />
  <!-- INPUT HIDDEN Postes de combat vaisseaux -->
  <input type="hidden" name="attr_POSTE_PIL" value="" />
  <input type="hidden" name="attr_POSTE_MOT" value="" />
  <input type="hidden" name="attr_POSTE_SEN" value="" />
  <input type="hidden" name="attr_POSTE_ORD" value="" />
  <!-- FIN Hidden -->
  <div class="sheet-container">
    <!-- Identité -->
    <div style="width: 420px; vertical-align: middle; text-align: center;">
      <img width="340" title="Version 3.4 - 01/01/2019" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_logo.png" />
    </div>
    <div style="width: 250px;">
      <table>
        <tr>
          <td class="sheet-textfatleft">Nom</td>
          <td colspan="3"><input class="sheet-nobox" name="attr_character_name" type="text" title="@{character_name}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Race</td>
          <td colspan="3"><input class="sheet-nobox" name="attr_RACE" type="text" title="@{RACE}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Profil</td>
          <td colspan="3"><input class="sheet-nobox" name="attr_PROFIL" type="text" title="@{PROFIL}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Niveau</td>
          <td style="text-align:left;"><input class="sheet-nobox" name="attr_NIVEAU" type="number" value="1" min="0" title="@{NIVEAU}" /></td>
          <td class="sheet-textfatleft">Type</td>
          <td class="sheet-boxinput">
            <select class="sheet-pjstatus" name="attr_type_personnage" size="1" title="@{type_personnage}">
              <option value="pj" selected>PJ</option>
              <option value="pnj">PNJ</option>
              <option value="vaisseau">Vaisseau</option>
            </select>
          </td>
        </tr>
      </table>
    </div>
    <div style="width: 110px;">
      <table>
        <tr>
          <td class="sheet-textfatleft">Sexe</td>
          <td><input class="sheet-nobox" name="attr_SEXE" type="text" title="@{SEXE}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Âge</td>
          <td><input class="sheet-nobox" name="attr_AGE" type="text" title="@{AGE}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Taille</td>
          <td><input class="sheet-nobox" name="attr_TAILLE" type="text" title="@{TAILLE}" /></td>
        </tr>
        <tr>
          <td class="sheet-textfatleft">Poids</td>
          <td><input class="sheet-nobox" name="attr_POIDS" type="text" title="@{POIDS}" /></td>
        </tr>
      </table>
    </div>
  </div> <!-- FIN Identité -->
  <input type="radio" name="attr_type_fiche" class="sheet-hidden-tab sheet-fp1" value="pj" checked="checked"><span title="Personnage"></span>
  <input type="radio" name="attr_type_fiche" class="sheet-hidden-tab sheet-fp2" value="vaisseau"><span title="Vaisseau"></span>
  <input type="radio" name="attr_type_fiche" class="sheet-hidden-tab sheet-fp3" value="pnj"><span title="PNJ"></span>
  <div class="sheet-tab-content sheet-fp1">
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab1" value="caracs" checked="checked"><span title="Caractéristiques"></span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab2" value="voies"><span title="Capacités"></span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab3" value="equip"><span title="Équipement"></span>
    <input type="radio" name="attr_tab" class="sheet-tab sheet-tab4" value="config"><span title="Configuration"></span>
    <img class="sheet-imghr-up" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    <div class="sheet-tab-content sheet-tab1">
      <div>
        <!-- Caracs + combat + PV + défense -->
        <table>
          <tr>
            <td style="width:250px; vertical-align: top;">
              <!-- Caracs + Chance -->
              <table class="sheet-tabsep">
                <!-- Caracs -->
                <tr>
                  <td class="sheet-textfat">CARAC.</td>
                  <td></td>
                  <td class="sheet-textbase">Valeur</td>
                  <td class="sheet-textfat">Mod.</td>
                  <td class="sheet-textbase">Bonus</td>
                  <td class="sheet-textfat">Test</td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_FOR" title="Jet de Force" value="@(togm}&{template:co1} {{perso=@{character_name}}} {{name=Force}} {{subtags=Test}} {{carac=[[@{FOR_SUP}[Dé] + [[@{FOR_TEST}]][Bonus] ]] }}"> FOR</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_FOR_SUP" title="@{FOR_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <option value="@{JETNORMAL}" selected>N Normale</option>
                      <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                      <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_FORCE" title="@{FORCE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR" title="@{FOR}" value="floor((@{FORCE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR_BONUS" title="@{FOR_BONUS} Bonus au Test" value="@{FOR_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR_TEST" title="@{FOR_TEST}" value="@{FOR}+@{FOR_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_DEX" title="Jet de Dext&eacute;rit&eacute;" value="@(togm}&{template:co1} {{perso=@{character_name}}} {{name=Dext&eacute;rit&eacute;}} {{subtags=Test}} {{carac=[[@{DEX_SUP}[Dé] + [[@{DEX_TEST}]][Bonus] ]] }}"> DEX</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_DEX_SUP" title="@{DEX_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <option value="@{JETNORMAL}" selected>N Normale</option>
                      <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                      <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_DEXTERITE" title="@{DEXTERITE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX" title="@{DEX}" value="floor((@{DEXTERITE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX_BONUS" title="@{DEX_BONUS} Bonus au Test" value="@{DEX_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX_TEST" title="@{DEX_TEST}" value="@{DEX}+@{DEX_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_CON" title="Jet de Constitution" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Constitution}} {{subtags=Test}} {{carac=[[@{CON_SUP}[Dé] + [[@{CON_TEST}]][Bonus] ]] }}"> CON</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_CON_SUP" title="@{CON_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <option value="@{JETNORMAL}" selected>N Normale</option>
                      <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                      <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_CONSTITUTION" title="@{CONSTITUTION}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON" title="@{CON}" value="floor((@{CONSTITUTION}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON_BONUS" title="@{CON_BONUS} Bonus au Test" value="@{CON_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON_TEST" title="@{CON_TEST}" value="@{CON}+@{CON_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_INT" title="Jet d'Intelligence" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Intelligence}} {{subtags=Test}} {{carac=[[@{INT_SUP}[Dé] + [[@{INT_TEST}]][Bonus] ]] }}"> INT</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_INT_SUP" title="@{INT_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <<option value="@{JETNORMAL}" selected>N Normale</option>
                        <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                        <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_INTELLIGENCE" title="@{INTELLIGENCE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT" title="@{INT}" value="floor((@{INTELLIGENCE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT_BONUS" title="@{INT_BONUS} Bonus au Test" value="@{INT_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT_TEST" title="@{INT_TEST}" value="@{INT}+@{INT_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_PER" title="Jet de Perception" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Perception}} {{subtags=Test}} {{carac=[[@{PER_SUP}[Dé] + [[@{PER_TEST}]][Bonus] ]] }}"> PER</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_PER_SUP" title="@{PER_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <option value="@{JETNORMAL}" selected>N Normale</option>
                      <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                      <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PERCEPTION" title="@{PERCEPTION}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER" title="@{PER}" value="floor((@{PERCEPTION}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER_BONUS" title="@{PER_BONUS} Bonus au Test" value="@{PER_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER_TEST" title="@{PER_TEST}" value="@{PER}+@{PER_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_CHA" title="Jet de Charisme" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Charisme}} {{subtags=Test}} {{carac=[[@{CHA_SUP}[Dé] + [[@{CHA_TEST}]][Bonus] ]] }}"> CHA</button></td>
                  <td class="sheet-boxinputlight">
                    <select class="sheet-selectmin" name="attr_CHA_SUP" title="@{CHA_SUP} Caractéristique Normale ou Supérieure/Héroïque (règle p.138)">
                      <option value="@{JETNORMAL}" selected>N Normale</option>
                      <option value="@{JETSUP}">S Supérieure OU Héroïque</option>
                      <option value="@{JETSUPHERO}">H Supérieure ET Héroïque</option>
                    </select>
                  </td>
                  <td class="sheet-boxinput"><input type="number" name="attr_CHARISME" title="@{CHARISME}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA" title="@{CHA}" value="floor((@{CHARISME}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA_BONUS" title="@{CHA_BONUS} Bonus au Test" value="@{CHA_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA_TEST" title="@{CHA_TEST}" value="@{CHA}+@{CHA_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-textfat" colspan="6">ÉTATS PRÉJUDICIABLES</td>
                </tr>
                <tr>
                  <td class="sheet-boxinputlight" colspan="6">
                    &nbsp;
                    <input type="radio" name="attr_ETATDE" value="20" title="@{ETATDE} Jet d'un d20 pour tous les tests" checked>&nbsp;Normal</input>
                    &nbsp;
                    <input type="radio" name="attr_ETATDE" value="12" title="@{ETATDE} Jet d'un d12 pour tous les tests">&nbsp;Affaibli</input>
                    &nbsp;
                    <input type="checkbox" name="attr_POISSE" title="@{POISSE} Moins bon de deux d20 pour tous les tests" value="1" />&nbsp;Poisse
                  </td>
                </tr>
                <tr>
                  <td class="sheet-boxinputlight" colspan="6">
                    Autres conditions :&nbsp;
                    <select class="sheet-carac" style="min-width: 100px;" name="attr_CONDITION" title="@{CONDITION}">
                      <option value="" selected>(aucune)</option>
                      <option value="A">Aveuglé</option>
                      <option value="E">Etourdi</option>
                      <option value="I">Immobilisé</option>
                      <option value="R">Renversé</option>
                      <option value="S">Surpris</option>
                    </select>
                  </td>
                </tr>
              </table> <!-- FIN Caracs -->
              <table class="sheet-tabsep" style="margin-top: 20px;">
                <!-- Chance -->
                <tr>
                  <td class="sheet-boxtitre" title="Points de Chance">PC</td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PC" value="0" title="@{PC} Points de Chance utilisés ou courants" /></td>
                  <td>/</td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PCRACE" title="@{PCRACE}Points de Chance de Race" value="0" /></td>
                  <td>+</td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PCDIV" title="@{PCDIV} Points de Chance additionnels" value="0" /></td>
                  <td>+</td>
                  <td class="sheet-boxinputlight"><INPUT type="number" name="attr_PCCAR" value="@{CHA}" title="@{PCCAR} Modificateur de Charisme" disabled /></td>
                  <td>=</td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PC_max" value="@{PCRACE}+@{PCDIV}+@{PCCAR}" title="@{PC|max} Points de Chance maximums" disabled /></td>
                </tr>
              </table> <!-- FIN Chance -->
            </td> <!-- FIN Caracs + Chance -->
            <td style="width:100%; vertical-align: top;">
              <!-- Combat + PV + défense -->
              <table>
                <tr>
                  <td style="vertical-align: top;">
                    <!-- Combat -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td class="sheet-textfat">COMBAT</td>
                        <td class="sheet-textbase">Base</td>
                        <td class="sheet-textbase">Mod.</td>
                        <td class="sheet-textbase">Div.</td>
                        <td class="sheet-textfat">Total</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_CAC" title="Jet d'attaque au contact" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Au Contact}} {{subtags=Attaque}} {{attaque=[[@{JETNORMAL}cs20cf1[Dé] + [[@{ATKCAC}]][Bonus] ]] }}"> AU CONTACT</button></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKCAC_BASE" value="0" title="@{ATKCAC_BASE} Score de base" /></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_ATKCAC_CARAC" size="1" title="@{ATKCAC_CARAC}">
                            <option value="@{FOR}" selected>FOR</option>
                            <option value="@{DEX}">DEX</option>
                            <option value="@{CON}">CON</option>
                            <option value="@{INT}">INT</option>
                            <option value="@{PER}">PER</option>
                            <option value="@{CHA}">CHA</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKCAC_DIV" title="@{ATKCAC_DIV} Bonus divers" value="@{ATKCAC_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKCAC" title="@{ATKCAC}" value="@{ATKCAC_BASE}+@{ATKCAC_CARAC}+@{ATKCAC_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_TIR" title="Jet d'attaque à distance" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=&Agrave; Distance}} {{subtags=Attaque}} {{attaque=[[@{JETNORMAL}cs20cf1[Dé] + [[@{ATKTIR}]][Bonus] ]] }}"> &Agrave; DISTANCE</button></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIR_BASE" value="0" title="@{ATKTIR_BASE} Score de base" /></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_ATKTIR_CARAC" size="1" title="@{ATKTIR_CARAC}">
                            <option value="@{FOR}">FOR</option>
                            <option value="@{DEX}" selected>DEX</option>
                            <option value="@{CON}">CON</option>
                            <option value="@{INT}">INT</option>
                            <option value="@{PER}">PER</option>
                            <option value="@{CHA}">CHA</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIR_DIV" title="@{ATKTIR_DIV} Bonus divers" value="@{ATKTIR_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIR" title="@{ATKTIR}" value="@{ATKTIR_BASE}+@{ATKTIR_CARAC}+@{ATKTIR_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_PSYINFLU" title="Jet d'attaque psychique : Influence" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Psychique (Influence)}} {{subtags=Attaque}} {{attaque=[[@{JETNORMAL}cs20cf1[Dé] + [[@{ATKPSYINFLU}]][Bonus] ]]}}"> PSY Influence</button></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKPSY_BASE" value="0" title="@{ATKPSY_BASE} Score de base" /></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_ATKPSYINFLU_CARAC" title="@{ATKPSYINFLU_CARAC}" size="1">
                            <option value="@{FOR}">FOR</option>
                            <option value="@{DEX}">DEX</option>
                            <option value="@{CON}">CON</option>
                            <option value="@{INT}">INT</option>
                            <option value="@{PER}">PER</option>
                            <option value="@{CHA}" selected>CHA</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKPSYINFLU_DIV" title="@{ATKPSYINFLU_DIV} Bonus divers" value="@{PSYINFLU_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKPSYINFLU" title="@{ATKPSYINFLU}" value="@{ATKPSY_BASE}+@{ATKPSYINFLU_CARAC}+@{ATKPSYINFLU_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_PSYINTUI" title="Jet d'attaque psychique : Intuition" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Psychique (Intuition)}} {{subtags=Attaque}} {{attaque=[[@{JETNORMAL}cs20cf1[Dé] + [[@{ATKPSYINTUI}]][Bonus] ]]}}"> PSY Intuition</button></td>
                        <td class="sheet-boxinputlight"><span name="attr_ATKPSY_BASE" title="@{ATKPSY_BASE} Score de base"></span></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_ATKPSYINTUI_CARAC" title="@{ATKPSYINTUI_CARAC}" size="1">
                            <option value="@{FOR}">FOR</option>
                            <option value="@{DEX}">DEX</option>
                            <option value="@{CON}">CON</option>
                            <option value="@{INT}">INT</option>
                            <option value="@{PER}" selected>PER</option>
                            <option value="@{CHA}">CHA</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKPSYINTUI_DIV" title="@{ATKPSYINTUI_DIV} Bonus divers" value="@{PSYINTUI_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKPSYINTUI" title="@{ATKPSYINTUI}" value="@{ATKPSY_BASE}+@{ATKPSYINTUI_CARAC}+@{ATKPSYINTUI_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_INIT" title="Initiative" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Initiative}} {{subtags=Combat}} {{carac=[[@{INIT}[Init.] + @{INIT_VAR}[Dé(s)] &{tracker}]]}}"> INITIATIVE</button></td>
                        <td>&nbsp;</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INIT_CARAC" title="@{INIT_CARAC}" value="@{DEXTERITE}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INIT_DIV" title="@{INIT_DIV} Bonus divers" value="@{INIT_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INIT" title="@{INIT}" value="@{INIT_CARAC}+@{INIT_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td>&nbsp;</td>
                      </tr>
                    </table>
                  </td> <!-- FIN Combat -->
                  <td style="vertical-align: top;">
                    <!-- PV -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td class="sheet-textfat" colspan="2">VITALIT&Eacute;</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_DV" title="Jet de D&eacute; de Vie" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Dé de Vie}} {{subtags=Vitalit&eacute;}} {{DV=[[1d@{DV}[DV] + [[@{CON}]][Mod. CON] ]]}}"> DV</button></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_DV" size="1" title="@{DV} D&eacute; de Vie">
                            <option value="0" selected>-</option>
                            <option value="4">d4</option>
                            <option value="6">d6</option>
                            <option value="8">d8</option>
                            <option value="10">d10</option>
                            <option value="12">d12</option>
                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_RECUP" title="Jet de Récupération" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Récupération}} {{subtags=Vitalit&eacute;}} {{RECUP=[[1d@{DV}[DV] + @{NIVEAU}[Niveau] + [[@{CON}]][Mod. CON] ]]}}"> PV</button></td>
                        <td class="sheet-boxinput"><input type="number" name="attr_PV_max" title="@{PV|max} Points de Vie maximum" value="0" /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxinput" COLSPAN="2">
                          <span class="textbase">PV restants</span>&nbsp;
                          <input type="number" name="attr_PV" title="@{PV} Points de Vie restants" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxinput" COLSPAN="2">
                          <span class="textbase">DM temp.</span>&nbsp;
                          <input type="number" name="attr_DMTEMP" title="@{DMTEMP} Dommages Temporaires" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxinput" COLSPAN="2">
                          &nbsp;<input type="checkbox" name="attr_BLESSURE" title="@{BLESSURE} Gravement blessé" value="1" />
                          <span class="textbase">Blessure grave</span>&nbsp;
                          <input type="number" name="attr_SEUILBG" title="@{SEUILBG} Seuil de blessure grave" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Réduction de dégâts">RD</td>
                        <td class="sheet-boxinput"><input type="number" name="attr_RD" title="@{RD} Réduction de dégâts" value="0" /></td>
                      </tr>
                      <tr>
                        <td>&nbsp;</td>
                      </tr>
                    </table>
                  </td> <!-- FIN PV -->
                </tr>
                <tr>
                  <td colspan="2" style="vertical-align: top;">
                    <!-- Défense -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td colspan="2" class="sheet-textfat">D&Eacute;FENSES</td>
                        <td class="sheet-textbase">Armure</td>
                        <td class="sheet-textbase">Bouclier</td>
                        <td class="sheet-textbase">Mod.</td>
                        <td class="sheet-textbase">Div.</td>
                        <td class="sheet-textbase">Action défensive</td>
                        <td class="sheet-textfat">Total</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">DEF</td>
                        <td class="sheet-boxinputlight">10+</td>
                        <td class="sheet-boxinput"><input type="number" name="attr_DEFARMURE" title="@{DEFARMURE} Armure" value="0" /></td>
                        <td class="sheet-boxinput"><input type="number" name="attr_DEFBOUCLIER" title="@{DEFBOUCLIER} Bouclier" value="0" /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFCAR" value="@{DEX}" title="@{DEFCAR} Modificateur de Dext&eacute;rit&eacute;" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFDIV" title="@{DEFDIV} Bonus divers" value="@{DEF_BUFF}" disabled /></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" style="width: 80px" name="attr_DEFACT" size="1" title="@{DEFACT} Actions défensives">
                            <option value="0" selected>-</option>
                            <option value="2">Simple</option>
                            <option value="4">Totale (L)</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEF" value="10+@{DEFARMURE}+@{DEFBOUCLIER}+@{DEFCAR}+@{DEFDIV}+@{DEFACT}" title="@{DEF} D&eacute;fense Physique" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">DEP</td>
                        <td class="sheet-boxinputlight">10+</td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEPCAR" value="@{CHA}" title="@{DEPCAR}Modificateur de Charisme" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEPDIV" title="@{DEPDIV} Bonus divers" value="@{DEP_BUFF}" disabled /></td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEP" value="10+@{DEPCAR}+@{DEPDIV}" title="@{DEP} Défense Psychique" disabled /></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td> <!-- FIN Combat + PV + défense -->
          </tr>
        </table>
      </div> <!-- FIN Caracs + combat + PV + défense  -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      <div>
        <!-- Armes -->
        <table class="sheet-tabsep" title="repeating_armes">
          <tr>
            <td class="sheet-textfatleft" style="width:155px;">ARMES / ATTAQUES</td>
            <td class="sheet-textbase" style="width: 150px;">ATTAQUE</td>
            <td class="sheet-textbase" style="width: 20px;">CRIT.</td>
            <td class="sheet-textbase" style="width: 200px;">DM</td>
            <td class="sheet-textbase" style="width: 40px;">PORTÉE</td>
            <td class="sheet-textbase" style="widht: 100%;">SPÉCIAL</td>
          </tr>
          <tr>
            <td class="sheet-textbase" colspan="2">Bonus tir visé (L) :&nbsp;
              <input type="checkbox" name="attr_visee_att" title="@{visee_att} Bonus de visée à l'attaque" value="@{PER}" />&nbsp;Attaque&nbsp;
              <input type="checkbox" name="attr_visee_dm" title="@{visee_att} Bonus de visée aux DM" value="@{PER}" />&nbsp;DM&nbsp;
            </td>
            <td>&nbsp;</td>
            <td class="sheet-textbase">
              <input type="checkbox" name="attr_tir_hc" title="@{tir_hc} Tir haute-capacité (+1d DM)" value="1" />&nbsp;Tir Haute-capacité (L)&nbsp;
            </td>
          </tr>
        </table>
        <fieldset class="repeating_armes">
          <div class="attack">
            <input class="options-flag" name="attr_armeoptflag" type="checkbox" title="Montrer/cacher les options"><span>y</span>
            <div>
              <table class="sheet-tabsep">
                <tr>
                  <td>
                    <button type="roll" class="sheet-neutre" name="attr_jet" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=@{armenom}}} {{subtags=Attaque}} {{portee=@{armeportee}}} {{desc=@{armejetn}}} @{armeatt}[[@{armejetd}cs>@{armecrit}cf<@{armeinct}[Dé] + [[@{armeatk}]][Attaque] + [[@{visee_att}]][Tir visé] + @{armeatkdiv}[Bonus] ]]}} @{armedmg}[[(@{armedmnbde}+1*@{tir_hc})d@{armedmde}@{armedmrel}@{armedmvrel}[Dé DM] + [[@{armedmcar}]][Mod.DM] + [[@{visee_dm}]][Tir visé] + @{armedmdiv}[Bonus DM] ]]}} {{special=@{armespec}}}" />
                  </td>
                  <td class="sheet-boxinputleft" style="min-width: 130px;">
                    <input type="text" name="attr_armenom" title="@{armenom}" style="font-weight: bold;" placeholder="Arme/attaque" />
                  </td>
                  <td class="sheet-boxinputleft" style="min-width: 150px;">
                    <input type="checkbox" name="attr_armeatt" title="@{armeatt} Faire un jet d'attaque pour toucher" value="{{attaque=" checked="checked" />
                    <select class="sheet-carac" style="width: 87px;" name="attr_armeatk" title="@{armeatk}" size="1">
                      <option value="@{ATKCAC}" selected>CONTACT</option>
                      <option value="@{ATKTIR}">DISTANCE</option>
                      <option value="@{ATKPSYINFLU}">PSY Inf.</option>
                      <option value="@{ATKPSYINTUI}">PSY Int.</option>
                    </select>+<input type="number" style="width: 32px;" name="attr_armeatkdiv" value="0" title="@{armeatkdiv} Bonus d'attaque divers" />
                  </td>
                  <td class="sheet-boxinputleft" style="text-align: right;">
                    <input type="number" name="attr_armecrit" style="width:32px;" min="2" max="20" value="20" title="@{armecrit} Seuil de Critique (par défaut 20)" />
                  </td>
                  <td class="sheet-boxinputleft">
                    <input type="checkbox" name="attr_armedmg" title="@{armedmg} Faire un jet de dommages" value="{{degats=" checked="checked" />
                    <input type="number" style="width:32px;" name="attr_armedmnbde" value="1" title="@{armedmnbde} Nombre de dés de dommage" />
                    <select class="sheet-carac" style="width: 47px;" name="attr_armedmde" size="1" title="@{armedmde} Dé de dommage">
                      <optgroup label="Normaux">
                        <option value="3">d3</option>
                        <option value="4">d4</option>
                        <option value="6" selected>d6</option>
                        <option value="8">d8</option>
                        <option value="10">d10</option>
                        <option value="12">d12</option>
                      </optgroup>
                      <optgroup label="Sans limite">
                        <option value="3!">d3</option>
                        <option value="4!">d4</option>
                        <option value="6!" selected>d6</option>
                        <option value="8!">d8</option>
                        <option value="10!">d10</option>
                        <option value="12!">d12</option>
                      </optgroup>
                    </select>+<select class="sheet-carac" style="width: 52px;" name="attr_armedmcar" size="1" title="@{armedmcar} Modificateur aux dommages">
                      <option value="0">-</option>
                      <optgroup label="Mod. de base">
                        <option value="@{FOR}" selected>FOR</option>
                        <option value="@{DEX}">DEX</option>
                        <option value="@{CON}">CON</option>
                        <option value="@{INT}">INT</option>
                        <option value="@{PER}">PER</option>
                        <option value="@{CHA}">CHA</option>
                      </optgroup>
                      <optgroup label="Mod. de test">
                        <option value="@{FOR_TEST}">FOR</option>
                        <option value="@{DEX_TEST}">DEX</option>
                        <option value="@{CON_TEST}">CON</option>
                        <option value="@{INT_TEST}">INT</option>
                        <option value="@{PER_TEST}">PER</option>
                        <option value="@{CHA_TEST}">CHA</option>
                      </optgroup>
                    </select>+<input type="number" style="width: 32px;" name="attr_armedmdiv" value="0" title="@{armedmdiv} Bonus de dommage divers" />
                  </td>
                  <td class="sheet-boxinputleft" style="min-width: 50px;">
                    <input type="text" name="attr_armeportee" placeholder="Portée" title="@{armeportee}" />
                  </td>
                  <td class="sheet-boxinputleft" style="width: 100%;">
                    <textarea name="attr_armespec" title="@{armespec}" placeholder="Notes, capacités spéciales, effet ..." title="Notes, capacités spéciales, effet ..."></textarea>
                  </td>
                </tr>
              </table>
            </div>
            <div class="options">
              <table class="sheet-tabsep">
                <tr>
                  <td style="width: 18px;">&nbsp;</td>
                  <td class="sheet-boxinputleft" style="width: 275px;">
                    <input type="text" name="attr_armejetn" style="width: 247px; font-weight: bold;" placeholder="Nom de l'attaque" title="@{armejetn}" />
                    <select class="sheet-carac" style="width: 30px;" name="attr_armejetd" size="1" title="@{armejetd} Jet d'attaque : Normal, 'Risque' = avec d12, 'Expert' = meilleur de deux d20">
                      <option value="@{JETNORMAL}" selected>N - Normal</option>
                      <option value="@{JETRISQUE}">R - Risque (d12)</option>
                      <option value="@{JETSUP}">E - Expert (2 d20)</option>
                    </select>
                  </td>
                  <td class="sheet-boxinputleft" style="width: 32px;">
                    <input type="number" style="width: 32px;" name="attr_armeinct" min="1" max="19" value="1" title="@{armeinct} Seuil d'incident de tir (par défaut 1)" />
                  </td>
                  <td class="sheet-boxinputleft" style="width: 200px;">
                    <select class="sheet-carac" style="width: 145px;" name="attr_armedmrel" size="1" title="@{armedmrel} Relance dés de DM = (r)eroll -- 1 fois = (r)eroll (o)nce">
                      <option value="" selected>Pas de relance DM</option>
                      <option value="r">Relance DM</option>
                      <option value="ro">Relance DM (1 fois)</option>
                    </select>
                    <input type="text" style="width: 55px;" name="attr_armedmvrel" title="@{armedmvrel} Seuil de relance (relance les 1 si non indiqué)" />
                  </td>
                  <td>&nbsp;</td>
                </tr>
              </table>
            </div>
          </div>
        </fieldset>
      </div>
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    </div>
    <div class="sheet-tab-content sheet-tab2">
      <div>
        <!-- Voies -->
        <table>
          <tr>
            <td class="sheet-textfatleft" COLSPAN="5">CAPACIT&Eacute;S DU PERSONNAGE</td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall" style="width: 20px;">&nbsp;</td>
            <td class="sheet-boxtitresmall">Voie 1</td>
            <td class="sheet-boxtitresmall">Voie 2</td>
            <td class="sheet-boxtitresmall">Voie 3</td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">R</td>
            <td class="sheet-boxinputleft"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie1nom" title="@{voie1nom}" placeholder="Nom de la Voie n°1" /></td>
            <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie2nom" placeholder="Nom de la Voie n°2" /></td>
            <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie3nom" placeholder="Nom de la Voie n°3" /></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">1</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie1-1" title="@{voie1-1}"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie2-1"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie3-1"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">2</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie1-2" title="@{voie1-2}"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie2-2"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie3-2"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">3</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie1-3" title="@{voie1-3}"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie2-3"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie3-3"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">4</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie1-4" title="@{voie1-4}"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie2-4"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie3-4"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">5</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie1-5" title="@{voie1-5}"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie2-5"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie3-5"></textarea></td>
          </tr>
        </table>
        <table>
          <tr>
            <td class="sheet-boxtitresmall" style="width: 20px;">&nbsp;</td>
            <td class="sheet-boxtitresmall">Voie 4</td>
            <td class="sheet-boxtitresmall">Voie 5</td>
            <td class="sheet-boxtitresmall">Voie 6</td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">R</td>
            <td class="sheet-boxinputleft"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie4nom" placeholder="Nom de la Voie n°4" /></td>
            <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie5nom" placeholder="Nom de la Voie n°5" /></td>
            <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie6nom" placeholder="Nom de la Voie n°6" /></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">1</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie4-1"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie5-1"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie6-1"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">2</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie4-2"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie5-2"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie6-2"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">3</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie4-3"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie5-3"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie6-3"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">4</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie4-4"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie5-4"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie6-4"></textarea></td>
          </tr>
          <tr>
            <td class="sheet-boxtitresmall">5</td>
            <td class="sheet-boxvoie"><textarea name="attr_voie4-5"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie5-5"></textarea></td>
            <td class="sheet-boxvoie"><textarea name="attr_voie6-5"></textarea></td>
          </tr>
        </table>
        <div>
          <input type="checkbox" class="sheet-block-switch" name="attr_voies789" title="@{voies789}" value="1"><span>Plus de voies</span>
          <div class="sheet-block-hidden"></div>
          <div class="sheet-block-show">
            <table>
              <tr>
                <td class="sheet-boxtitresmall" style="width: 20px;">&nbsp;</td>
                <td class="sheet-boxtitresmall">Voie 7</td>
                <td class="sheet-boxtitresmall">Voie 8</td>
                <td class="sheet-boxtitresmall">Voie 9</td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">R</td>
                <td class="sheet-boxinputleft"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie7nom" placeholder="Nom de la Voie n°7" /></td>
                <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie8nom" placeholder="Nom de la Voie n°8" /></td>
                <td class="sheet-boxinput"><input type="text" style="font-weight: bold;text-align: center;" name="attr_voie9nom" placeholder="Nom de la Voie n°9" /></td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">1</td>
                <td class="sheet-boxvoie"><textarea name="attr_voie7-1"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie8-1"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie9-1"></textarea></td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">2</td>
                <td class="sheet-boxvoie"><textarea name="attr_voie7-2"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie8-2"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie9-2"></textarea></td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">3</td>
                <td class="sheet-boxvoie"><textarea name="attr_voie7-3"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie8-3"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie9-3"></textarea></td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">4</td>
                <td class="sheet-boxvoie"><textarea name="attr_voie7-4"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie8-4"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie9-4"></textarea></td>
              </tr>
              <tr>
                <td class="sheet-boxtitresmall">5</td>
                <td class="sheet-boxvoie"><textarea name="attr_voie7-5"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie8-5"></textarea></td>
                <td class="sheet-boxvoie"><textarea name="attr_voie9-5"></textarea></td>
              </tr>
            </table>
          </div>
        </div>
        <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
        <table class="sheet-tabsep" title="repeating_jetcapas">
          <tr>
            <td class="sheet-textfatleft" style="min-width:245px;">Jets de Capacités</td>
            <td class="sheet-textbase" style="width:100%;">&nbsp;</td>
          </tr>
        </table>
        <fieldset class="repeating_jetcapas">
          <table class="sheet-tabsep">
            <tr>
              <td>
                <button type="roll" class="sheet-neutre" name="attr_jet" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=@{jetcapanom}}} {{subtags=Capacité}} {{carac=[[@{jetcapanbde}d@{jetcapade}@{jetcapatypjet} + [[@{jetcapacarac}]] + @{jetcapadiv}]] }} {{desc=@{jetcapadesc}}}" />
              </td>
              <td class="sheet-boxinputleft" style="min-width:200px;">
                <input type="text" name="attr_jetcapanom" title="@{jetcapanom}" style="font-weight: bold;" placeholder="Nom du Jet de capacité" />
              </td>
              <td class="sheet-textbase" style="text-align: right;">
                Jet
              </td>
              <td class="sheet-boxinputleft">
                <input type="number" style="width:32px;" name="attr_jetcapanbde" value="1" title="@{jetcapanbde} Nombre de dés" />
                <select class="sheet-carac" style="width:50px;" name="attr_jetcapade" size="1" title="@{jetcapade} Dé (d20 => d12 si Affaibli)">
                  <option value="4">d4</option>
                  <option value="6">d6</option>
                  <option value="8">d8</option>
                  <option value="10">d10</option>
                  <option value="12">d12</option>
                  <option value="@{ETATDE}" selected>d20 (ou d12 si Affaibli)</option>
                </select>
                (<select class="sheet-carac" style="width:30px;" name="attr_jetcapatypjet" size="1" title="@{jetcapatypjet} Option du jet : normal, meilleur dé, moins bon dé, sans limite">
                  <option value="">N - Normal</option>
                  <option value="kh1">S - Garder le meilleur dé</option>
                  <option value="kl1">I - Garder le moins bon dé</option>
                  <option value="!">E - Explosif (jet sans limite)</option>
                </select>)
                +<select class="sheet-carac" style="width:60px;" name="attr_jetcapacarac" size="1" title="@{jetcapacarac} Modificateur du jet">
                  <option value="0">-</option>
                  <optgroup label="Mod. de base">
                    <option value="@{FOR}" selected>FOR</option>
                    <option value="@{DEX}">DEX</option>
                    <option value="@{CON}">CON</option>
                    <option value="@{INT}">INT</option>
                    <option value="@{PER}">PER</option>
                    <option value="@{CHA}">CHA</option>
                    <option value="@{QRYMOD}">Choix</option>
                  </optgroup>
                  <optgroup label="Mod. de test">
                    <option value="@{FOR_TEST}">FOR</option>
                    <option value="@{DEX_TEST}">DEX</option>
                    <option value="@{CON_TEST}">CON</option>
                    <option value="@{INT_TEST}">INT</option>
                    <option value="@{PER_TEST}">PER</option>
                    <option value="@{CHA_TEST}">CHA</option>
                    <option value="@{QRYMODT}">Choix</option>
                  </optgroup>
                  <optgroup label="Attaques">
                    <option value="@{ATKCAC}">ATC</option>
                    <option value="@{ATKTIR}">ATD</option>
                    <option value="@{ATKPSYINFLU}">Influ. Psy</option>
                    <option value="@{ATKPSYINTUI}">Intui. Psy</option>
                  </optgroup>
                </select>+<input type="number" style="width:32px;" name="attr_jetcapadiv" value="0" title="@{jetcapadiv} Bonus divers" />
              </td>
              <td class="sheet-boxinputleft" style="width:100%;">
                <textarea name="attr_jetcapadesc" placeholder="Description" title="@{jetcapadesc}"></textarea>
              </td>
            </tr>
          </table>
        </fieldset>
      </div> <!-- FIN Voies -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      <div>
        <span class="sheet-textfatleft">Traits</span>
        <fieldset class="repeating_traits">
          <table class="sheet-tabsep">
            <tr>
              <td style="width: 15px;">
                <button type="roll" name="attr_chat" class="sheet-output" value="/w &quot;@{character_name}&quot; &{template:co1} {{perso=@{character_name}}} {{name=@{traitnom}}} {{subtags=@{traittype}}} {{text=@{traitdesc}}}">w</button>
              </td>
              <td class="sheet-boxinputleft" style="width: 200px;"><input type="text" style="font-weight: bold;" name="attr_traitnom" placeholder="Nom du trait" title="@{traitnom}" /></td>
              <td class="sheet-boxinputleft" style="width: 150px;"><input type="text" name="attr_traittype" placeholder="Origine/Type de trait" title="@{traittype}" /></td>
              <td class="sheet-boxinputleft"><textarea name="attr_traitdesc" placeholder="Description" title="@{traitdesc}"></textarea></td>
            </tr>
          </table>
        </fieldset>
      </div>
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    </div>
    <div class="sheet-tab-content sheet-tab3">
      <div>
        <!-- Equipement et règles optionnelles -->
        <div class="sheet-2colrow">
          <div class="sheet-col" title="repeating_equipement">
            <div class="sheet-boxtitre">&Eacute;QUIPEMENT : Consommables</div>
            <div class="sheet-boxinputleft">
              <span class="textbase">Crédits&nbsp;:</span>&nbsp;
              <input type="text" style="width:320px;" name="attr_RICHESSE" title="@{RICHESSE}" placeholder="Rien ? C'est la pauvret&eacute; !" />
            </div>
            <fieldset class="repeating_equipement">
              <div class="sheet-boxvoie">
                <input type="text" style="width:310px;" name="attr_equip-nom" title="@{equip-nom}" />
                &nbsp;<span class="sheet-textbase">Qt&eacute;</span>
                <input type="number" name="attr_equip-qte" value="1" title="@{equip-qte}" />
              </div>
            </fieldset>
          </div>
          <div class="sheet-col" title="repeating_materiel">
            <div class="sheet-boxtitre">&Eacute;QUIPEMENT : Personnel</div>
            <fieldset class="repeating_materiel">
              <div class="sheet-boxvoie">
                <input type="text" name="attr_mater-nom" title="@{mater-nom}" />
              </div>
            </fieldset>
          </div>
        </div>
        <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
        <div class="sheet-2colrow">
          <div class="sheet-col">
            <table>
              <tr>
                <td class="sheet-boxtitre">&Eacute;QUIPEMENT : Divers</td>
              </tr>
              <tr>
                <td class="sheet-boxinputleft"><textarea name="attr_equip-div" style="height:15em;" title="@{equip-div}"></textarea></td>
              </tr>
            </table>
          </div>
          <div class="sheet-col">
            <table>
              <tr>
                <td class="sheet-boxtitre">Notes</td>
              </tr>
              <tr>
                <td class="sheet-boxinputleft"><textarea name="attr_notes" style="height:15em;" title="@{notes}"></textarea></td>
              </tr>
            </table>
          </div>
        </div>
        <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      </div> <!-- FIN Equipement et règles optionnelles -->
    </div>
    <div class="sheet-tab-content sheet-tab4">
      <div class="sheet-row">
        <!-- Config -->
        <table class="sheet-tabsep">
          <tr>
            <td style="width: 15%;">
              <span class="textbase">Jets</span>&nbsp;
              <select class="sheet-carac" style="width: 75px;" name="attr_togm" title="@{togm}" size="1">
                <option value="" selected>Normaux</option>
                <option value="/w gm ">Cachés</option>
              </select>
            </td>
            <td style="width: 20%;">
              <span class="textbase">Initiative variable</span>&nbsp;<input type="checkbox" name="attr_INIT_VAR" title="@{INIT_VAR}" value="[[1d6!]]" />
            </td>
            <td style="width: 25%;"></td>
            <td style="width: 20%;"></td>
            <td style="width: 20%;"></td>
          </tr>
        </table>
      </div> <!-- FIN Config -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      <div class="sheet-row">
        <!-- BUFFS -->
        <div class="sheet-textfatleft">BUFFS</div>
        <table class="sheet-tabsep">
          <tr>
            <td style="width: 5%;">FOR:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">DEX:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">CON:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">INT:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">PER:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">CHA:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">ATC:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKCAC_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_ATKCAC_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKCAC_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_ATKCAC_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKCAC_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_ATKCAC_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKCAC_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_ATKCAC_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKCAC_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_ATKCAC_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">ATD:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIR_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIR_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIR_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIR_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIR_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIR_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIR_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIR_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIR_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIR_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">MAG:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMAG_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMAG_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMAG_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMAG_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMAG_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMAG_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMAG_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMAG_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMAG_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMAG_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">MEN:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMEN_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMEN_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMEN_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMEN_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMEN_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMEN_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMEN_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMEN_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKMEN_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_ATKMEN_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">INIT:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">DEF:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEF_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEF_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEF_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEF_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEF_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEF_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEF_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEF_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEF_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEF_BUFF5" />
            </td>
          </tr>
        </table>
        <div>
          <input type="checkbox" class="sheet-block-switch" name="attr_voir_psy" title="@{voir_psy}" value="1"><span>Afficher les attributs PSY</span>
          <div class="sheet-block-hidden"></div>
          <div class="sheet-block-show">
            <table>
              <tr>
                <td style="width: 5%;">PSYInf.:</td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINFLU_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINFLU_BUFF1" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINFLU_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINFLU_BUFF2" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINFLU_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINFLU_BUFF3" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINFLU_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINFLU_BUFF4" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINFLU_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINFLU_BUFF5" />
                </td>
              </tr>
              <tr>
                <td style="width: 5%;">PSYInt.:</td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINTUI_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINTUI_BUFF1" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINTUI_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINTUI_BUFF2" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINTUI_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINTUI_BUFF3" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINTUI_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINTUI_BUFF4" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PSYINTUI_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_PSYINTUI_BUFF5" />
                </td>
              </tr>
              <tr>
                <td style="width: 5%;">DEFPsy:</td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEP_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEP_BUFF1" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEP_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEP_BUFF2" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEP_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEP_BUFF3" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEP_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEP_BUFF4" />
                </td>
                <td style="width: 19%;">
                  <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEP_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEP_BUFF5" />
                </td>
              </tr>
            </table>
          </div>
        </div>
      </div> <!-- FIN BUFFS -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    </div>
  </div>
  <div class="sheet-tab-content sheet-fp2">
    <input type="radio" name="attr_tabvaiss" class="sheet-tab sheet-tab1" value="caracs" checked="checked"><span title="Caractéristiques"></span>
    <input type="radio" name="attr_tabvaiss" class="sheet-tab sheet-tab2" value="config"><span title="Configuration"></span>
    <img class="sheet-imghr-up" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    <div class="sheet-tab-content sheet-tab1">
      <div>
        <!-- Caracs + combat + PV + défense -->
        <table>
          <tr>
            <td style="width:250px; vertical-align: top;">
              <!-- Caracs + Chance -->
              <table class="sheet-tabsep">
                <!-- Caracs -->
                <tr>
                  <td class="sheet-textfat">CARAC.</td>
                  <td></td>
                  <td class="sheet-textbase">Valeur</td>
                  <td class="sheet-textfat">Mod.</td>
                  <td class="sheet-textbase">Bonus</td>
                  <td class="sheet-textfat">Test</td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_FOR" title="Jet de Puissance" value="@(togm}&{template:co1} {{perso=@{character_name}}} {{name=Puissance}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] +[[@{FOR_TEST}]][Puissance] +@{POSTE_MOT} ]] }}"> FOR</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_FORCE" title="@{FORCE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR" title="@{FOR}" value="floor((@{FORCE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR_BONUS" title="@{FOR_BONUS} Bonus au Test" value="@{FOR_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_FOR_TEST" title="@{FOR_TEST}" value="@{FOR}+@{FOR_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_DEX" title="Jet de Manoeuvrabilit&eacute;" value="@(togm}&{template:co1} {{perso=@{character_name}}} {{name=Manoeuvrabilit&eacute;}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] +[[@{DEX_TEST}]][Manoeuvrabilit&eacute;] +@{POSTE_PIL} ]] }}"> DEX</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_DEXTERITE" title="@{DEXTERITE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX" title="@{DEX}" value="floor((@{DEXTERITE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX_BONUS" title="@{DEX_BONUS} Bonus au Test" value="@{DEX_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_DEX_TEST" title="@{DEX_TEST}" value="@{DEX}+@{DEX_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_CON" title="Jet de Coque" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Coque}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] + [[@{CON_TEST}]][Bonus] ]] }}"> CON</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_CONSTITUTION" title="@{CONSTITUTION}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON" title="@{CON}" value="floor((@{CONSTITUTION}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON_BONUS" title="@{CON_BONS} Bonus au Test" value="@{CON_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CON_TEST" title="@{CON_TEST}" value="@{CON}+@{CON_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_INT" title="Jet d'Ordinateurs de Vis&eacute;e" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Ordinateur de Visée}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] +[[@{INT_TEST}]][Bonus] ]] }}"> INT</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_INTELLIGENCE" title="@{INTELLIGENCE}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT" title="@{INT}" value="floor((@{INTELLIGENCE}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT_BONUS" title="@{INT_BONUS} Bonus au Test" value="@{INT_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_INT_TEST" title="@{INT_TEST}" value="@{INT}+@{INT_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_PER" title="Jet de Senseurs" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Senseurs}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] +[[@{PER_TEST}]][Senseurs] +@{POSTE_SEN} ]] }}"> PER</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PERCEPTION" title="@{PERCEPTION}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER" title="@{PER}" value="floor((@{PERCEPTION}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER_BONUS" title="@{PER_BONUS} Bonus au Test" value="@{PER_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PER_TEST" title="@{PER_TEST}" value="@{PER}+@{PER_BONUS}" disabled /></td>
                </tr>
                <tr>
                  <td class="sheet-boxtitre" colspan="2"><button class="sheet-boxtitre" type="roll" name="JET_CHA" title="Jet de Communications" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Communications}} {{subtags=Test}} {{carac=[[1d20cs20cf1[Dé] + [[@{CHA_TEST}]][Comm.Systèmes] +@{POSTE_ORD} ]] }}"> CHA</button></td>
                  <td class="sheet-boxinput"><input type="number" name="attr_CHARISME" title="@{CHARISME}" value="10" min="0" /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA" title="@{CHA}" value="floor((@{CHARISME}-10)/2)" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA_BONUS" title="@{CHA_BONUS} Bonus au Test" value="@{CHA_BUFF}" disabled /></td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_CHA_TEST" title="@{CHA_TEST}" value="@{CHA}+@{CHA_BONUS}" disabled /></td>
                </tr>
              </table> <!-- FIN Caracs -->
              <table class="sheet-tabsep" style="margin-top: 20px;">
                <!-- Energie -->
                <tr>
                  <td class="sheet-boxtitre" title="Points d'énergie">PE</td>
                  <td class="sheet-boxinput"><input type="number" name="attr_PEV" value="0" title="@{PEV} Points d'énergie utilisés ou courants" /></td>
                  <td>/</td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PEVBASE" title="@{PEVBASE} Points d'énergie de base" value="@{NIVEAU}" disabled /></td>
                  <td>+</td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PEVDIV" title="@{PEVDIV} Points d'énergie additionnels" value="@{PEV_BUFF}" disabled /></td>
                  <td>+</td>
                  <td class="sheet-boxinputlight"><INPUT type="number" name="attr_PEVCAR" value="@{FOR}" title="@{PEVCAR} Mod. de puissance (FOR)" disabled /></td>
                  <td>=</td>
                  <td class="sheet-boxinputlight"><input type="number" name="attr_PEV_max" value="@{PEVBASE}+@{PEVDIV}+@{PEVCAR}" title="Points d'énergie maximums" disabled /></td>
                </tr>
              </table> <!-- FIN Energie -->
            </td> <!-- FIN Caracs + Chance -->
            <td style="width:100%; vertical-align: top;">
              <!-- Combat + PV + défense -->
              <table>
                <tr>
                  <td style="vertical-align: top;">
                    <!-- Combat -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td class="sheet-textfat">COMBAT</td>
                        <td class="sheet-textbase">Base</td>
                        <td class="sheet-textbase">Mod.</td>
                        <td class="sheet-textbase">Div.</td>
                        <td class="sheet-textfat">Total</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_TIRV" title="Jet d'attaque à distance" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=&Agrave; Distance}} {{subtags=Attaque}} {{attaque=[[1d20cs20cf1[Dé] + [[@{ATKTIRV}]][Bonus] ]] }}"> &Agrave; DISTANCE</button></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIRV_BASE" value="@{NIVEAU}" title="@{ATKTIRV_BASE} Score de base" disabled /></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_ATKTIRV_CARAC" size="1" title="@{ATKTIRV_CARAC}">
                            <option value="@{INT}" selected>INT</option>
                          </select>
                        </td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIRV_DIV" title="@{ATKTIRV_DIV} Bonus divers" value="@{ATKTIRV_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_ATKTIRV" title="@{ATKTIRV}" value="@{ATKTIRV_BASE}+@{ATKTIRV_CARAC}+@{ATKTIRV_DIV}" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Poste de pilotage (PIL)">Pilotage</td>
                        <td class="sheet-boxinput" colspan="4">
                          <input type="text" style="width: 220px;" name="attr_POSTE_PIL_NOM" title="@{POSTE_PIL_NOM}" placeholder="Nom du pilote" />
                          <input type="number" name="attr_POSTE_PIL_BONUS" title="@{POSTE_PIL_BONUS} Rangs dans la Voie du Pilotage" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Salle des machines (MOT)">Machines</td>
                        <td class="sheet-boxinput" colspan="4">
                          <input type="text" style="width: 220px;" name="attr_POSTE_MOT_NOM" title="@{POSTE_MOT_NOM}" placeholder="Nom du mécanicien" />
                          <input type="number" name="attr_POSTE_MOT_BONUS" title="@{POSTE_MOT_BONUS} Rangs dans la Voie des Moteurs" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Console des senseurs (SEN)">Senseurs</td>
                        <td class="sheet-boxinput" colspan="4">
                          <input type="text" style="width: 220px;" name="attr_POSTE_SEN_NOM" title="@{POSTE_SEN_NOM}" placeholder="Nom du scantech" />
                          <input type="number" name="attr_POSTE_SEN_BONUS" title="@{POSTE_SEN_BONUS} Rangs dans la Voie de l'Electronique" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Console du système (ORD)">Ordinateurs</td>
                        <td class="sheet-boxinput" colspan="4">
                          <input type="text" style="width: 220px;" name="attr_POSTE_ORD_NOM" title="@{POSTE_ORD_NOM}" placeholder="Nom de l'infotech" />
                          <input type="number" name="attr_POSTE_ORD_BONUS" title="@{POSTE_ORD_BONUS} Rangs dans la Voie de l'Electronique" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="JET_INIT" title="Initiative" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=Initiative}} {{subtags=Combat}} {{carac=[[@{INITV} + @{INIT_VAR}[Dé(s)] &{tracker}]]}}"> INITIATIVE</button></td>
                        <td>&nbsp;</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INITV_CARAC" title="@{INITV_CARAC}" value="@{DEX}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INITV_PIL" title="@{INITV_PIL} Valeur de DEX du pilote" value="@{INIT_BUFF}" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_INITV" title="@{INITV}" value="[[@{INITV_CARAC}]][Manoeuvrabilité]+[[@{INITV_PIL}]][DEX pilote]" disabled /></td>
                      </tr>
                    </table>
                  </td> <!-- FIN Combat -->
                  <td style="vertical-align: top;">
                    <!-- PV -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td class="sheet-textfat" colspan="2">STRUCTURE</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">DV</button></td>
                        <td class="sheet-boxinput">
                          <select class="sheet-carac" name="attr_DV" size="1" title="@{DV} D&eacute; de Structure">
                            <option value="0" selected>-</option>
                            <option value="4">d4</option>
                            <option value="6">d6</option>
                            <option value="8">d8</option>
                            <option value="10">d10</option>
                            <option value="12">d12</option>
                          </select>
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">PV</button></td>
                        <td class="sheet-boxinput"><input type="number" name="attr_PV_max" title="@{PV|max} Points de Structure maximum" value="0" /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxinput" COLSPAN="2">
                          <span class="textbase">PV restants</span>&nbsp;
                          <input type="number" name="attr_PV" title="@{PV} Points de Structure restants" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxinput" COLSPAN="2">
                          <span class="textbase">DM temp.</span>&nbsp;
                          <input type="number" name="attr_DMTEMP" title="@{DMTEMP} Dommages EMP" value="0" />
                        </td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre" title="Boucliers (réduction des dommages)">RD</td>
                        <td class="sheet-boxinput"><input type="number" name="attr_RD" title="@{RD} Réduction des dommages" value="0" /></td>
                      </tr>
                      <tr>
                        <td>&nbsp;</td>
                      </tr>
                    </table>
                  </td> <!-- FIN PV -->
                </tr>
                <tr>
                  <td colspan="2" style="vertical-align: top;">
                    <!-- Défense -->
                    <table class="sheet-tabsep">
                      <tr>
                        <td class="sheet-textfat">D&Eacute;FENSES</td>
                        <td>&nbsp;</td>
                        <td class="sheet-textbase">Mod. DEX/CON</td>
                        <td class="sheet-textbase">Pilote</td>
                        <td class="sheet-textbase">Mod. PER</td>
                        <td class="sheet-textbase">Scantech</td>
                        <td class="sheet-textfat">Total</td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">DEF (rapidité)</td>
                        <td class="sheet-boxinputlight">10+</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFVDEX" value="@{DEX}" title="@{DEFVDEX} Bonus de Manoeuvrabilit&eacute;" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFVPIL" value="@{DEFVPIL_BUFF}" title="@{DEFVPIL} Bonus du Pilote" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFVPER" value="@{PER}" title="@{DEFVPER} Bonus de Senseurs" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFVSEN" value="@{DEFVSEN_BUFF}" title="@{DEFVSEN} Bonus du Scantech" disabled /></td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFRAP" value="10+@{DEFVDEX}+@{DEFVPIL}+@{DEFVPER}+@{DEFVSEN}" title="@{DEFRAP} D&eacute;fense (rapidit&eacute;)" disabled /></td>
                      </tr>
                      <tr>
                        <td class="sheet-boxtitre">DEF (solidité)</td>
                        <td class="sheet-boxinputlight">10+</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFVCON" value="@{CON}" title="@{DEFVCON} Bonus de Coque" disabled /></td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-textbase">&nbsp;</td>
                        <td class="sheet-boxinputlight"><input type="number" name="attr_DEFSOL" value="10+@{DEFVCON}+@{DEFVPER}+@{DEFVSEN}" title="@{DEFSOL} D&eacute;fense (solidit&eacute;)" disabled /></td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
            </td> <!-- FIN Combat + PV + défense -->
          </tr>
        </table>
      </div> <!-- FIN Caracs + combat + PV + défense  -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      <div>
        <!-- Armes -->
        <table class="sheet-tabsep" title="repeating_armesv">
          <tr>
            <td class="sheet-textfatleft" style="width:155px;">ARMES / ATTAQUES</td>
            <td class="sheet-textbase" style="width:140px;">ATTAQUE</td>
            <td class="sheet-textbase" style="width:20px;">CRIT.</td>
            <td class="sheet-textbase" style="width:185px;">DM</td>
            <td class="sheet-textbase" style="widht:100%;">SPÉCIAL</td>
          </tr>
        </table>
        <fieldset class="repeating_armesv">
          <div class="attack">
            <input class="options-flag" name="attr_armeoptflag" type="checkbox" title="Montrer/cacher les options"><span>y</span>
            <div>
              <input type="hidden" name="attr_armecan" value="" />
              <table class="sheet-tabsep">
                <tr>
                  <td>
                    <button type="roll" class="sheet-neutre" name="attr_jet" value="@{togm}&{template:co1} {{perso=@{character_name}}} {{name=@{armenom}}} {{subtags=Attaque}} {{desc=@{armejetn}}} {{attaque=[[@{armejetd}cs>@{armecrit}cf<@{armeinct}[Dé] + [[@{armeatk}]][Attaque] + @{armecan} + @{armeatkdiv}[Bonus] ]]}} {{degats=[[@{armedmnbde}d@{armedmde}[Dé DM] + [[@{armedmcar}]][Mod.DM] + @{armedmdiv}[Bonus DM] ]]}} {{special=@{armespec}}}" />
                  </td>
                  <td class="sheet-boxinputleft" style="min-width: 130px;">
                    <input type="text" name="attr_armenom" title="@{armenom}" style="font-weight: bold;" placeholder="Arme/attaque" />
                  </td>
                  <td class="sheet-boxinputleft" style="min-width: 145px;">
                    <select class="sheet-carac" style="width: 87px;" name="attr_armeatk" title="@{armeatk}" size="1">
                      <option value="@{ATKTIRV}" selected>DISTANCE</option>
                    </select>+<input type="number" style="width:32px;" name="attr_armeatkdiv" value="0" title="@{armeatkdiv} Bonus d'attaque divers" />
                  </td>
                  <td class="sheet-boxinputleft" style="text-align: right;">
                    <input type="number" name="attr_armecrit" style="width:32px;" min="2" max="20" value="20" title="@{armecrit} Seuil de Critique (par défaut 20)" />
                  </td>
                  <td class="sheet-boxinputleft">
                    <input type="number" style="width:32px;" name="attr_armedmnbde" value="1" title="@{armedmnbde} Nombre de dés de dommage" />
                    <select class="sheet-carac" style="width:47px;" name="attr_armedmde" size="1" title="@{armedmde} Dé de dommage">
                      <option value="4">d4</option>
                      <option value="6" selected>d6</option>
                      <option value="8">d8</option>
                      <option value="10">d10</option>
                      <option value="12">d12</option>
                    </select>+<select class="sheet-carac" style="width:52px;" name="attr_armedmcar" size="1" title="@{armedmcar} Modificateur aux dommages">
                      <option value="0">-</option>
                      <optgroup label="Mod. de base">
                        <option value="@{FOR}">FOR</option>
                        <option value="@{DEX}">DEX</option>
                        <option value="@{CON}">CON</option>
                        <option value="@{INT}">INT</option>
                        <option value="@{PER}">PER</option>
                        <option value="@{CHA}">CHA</option>
                      </optgroup>
                      <optgroup label="Mod. de test">
                        <option value="@{FOR_TEST}" selected>FOR</option>
                        <option value="@{DEX_TEST}">DEX</option>
                        <option value="@{CON_TEST}">CON</option>
                        <option value="@{INT_TEST}">INT</option>
                        <option value="@{PER_TEST}">PER</option>
                        <option value="@{CHA_TEST}">CHA</option>
                      </optgroup>
                    </select>+<input type="number" style="width:32px;" name="attr_armedmdiv" value="0" title="@{armedmdiv} Bonus de dommage divers" />
                  </td>
                  <td class="sheet-boxinputleft" style="width:100%;">
                    <textarea name="attr_armespec" title="@{armespec}" placeholder="Notes, capacités spéciales, effet ..." title="@{armespec} Notes, capacités spéciales, effet ..."></textarea>
                  </td>
                </tr>
              </table>
            </div>
            <div class="options">
              <table class="sheet-tabsep">
                <tr>
                  <td style="width: 18px;">&nbsp;</td>
                  <td class="sheet-boxinputleft" style="width: 272px;">
                    <input type="text" name="attr_armejetn" style="width: 242px; font-weight: bold;" placeholder="Nom de l'attaque" title="@{armejetn}" />
                    <select class="sheet-carac" style="width: 30px;" name="attr_armejetd" size="1" title="@{armejetd} Jet d'attaque : 'Risque' = avec d12, 'Expert' = meilleur de deux d20">
                      <option value="1d20" selected>Normal</option>
                      <option value="1d12">Risque (d12)</option>
                      <option value="2d20kh1">Expert (2 d20)</option>
                    </select>
                  </td>
                  <td class="sheet-boxinputleft" style="width: 32px;">
                    <input type="number" style="width: 32px;" name="attr_armeinct" min="1" max="19" value="1" title="@{armeinct} Seuil d'incident de tir (par défaut 1)" />
                  </td>
                  <td class="sheet-boxinputleft" style="width: 250px;">
                    <input type="text" style="width: 220px;" name="attr_armecan_nom" title="@{armecan_nom} Nom du canonnier (CAN)" />
                    <input type="number" name="attr_armecan_bonus" title="@{armecan_bonus} Rang armes lourdes (CAN)" value="0" />
                  </td>
                  <td>&nbsp;</td>
                </tr>
              </table>
            </div>
          </div>
        </fieldset>
      </div>
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    </div>
    <div class="sheet-tab-content sheet-tab2">
      <div class="sheet-row">
        <!-- Config -->
        <table class="sheet-tabsep">
          <tr>
            <td style="width: 15%;">
              <span class="textbase">Jets</span>&nbsp;
              <select class="sheet-carac" style="width: 75px;" name="attr_togm" title="@{togm}" size="1">
                <option value="" selected>Normaux</option>
                <option value="/w gm ">Cachés</option>
              </select>
            </td>
            <td style="width: 20%;">
              <span class="textbase">Initiative variable</span>&nbsp;<input type="checkbox" name="attr_INIT_VAR" title="@{INIT_VAR}" value="[[1d6!]]" />
            </td>
            <td style="width: 25%;"></td>
            <td style="width: 20%;"></td>
            <td style="width: 20%;"></td>
          </tr>
        </table>
      </div> <!-- FIN Config -->
      <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
      <div class="sheet-row">
        <!-- BUFFS -->
        <div class="sheet-textfatleft">BUFFS</div>
        <table class="sheet-tabsep">
          <tr>
            <td style="width: 5%;">FOR:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_FOR_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_FOR_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">DEX:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEX_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEX_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">CON:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CON_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_CON_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">INT:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INT_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_INT_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">PER:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PER_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_PER_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">CHA:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_CHA_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_CHA_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">ATD:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIRV_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIRV_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIRV_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIRV_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIRV_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIRV_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIRV_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIRV_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_ATKTIRV_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_ATKTIRV_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">INIT:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_INIT_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_INIT_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">PIL:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVPIL_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVPIL_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVPIL_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVPIL_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVPIL_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVPIL_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVPIL_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVPIL_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVPIL_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVPIL_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">SEN:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVSEN_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVSEN_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVSEN_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVSEN_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVSEN_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVSEN_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVSEN_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVSEN_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_DEFVSEN_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_DEFVSEN_BUFF5" />
            </td>
          </tr>
          <tr>
            <td style="width: 5%;">PE:</td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PEV_BUFF1_DESC" /><input class="sheet-buff" type="number" name="attr_PEV_BUFF1" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PEV_BUFF2_DESC" /><input class="sheet-buff" type="number" name="attr_PEV_BUFF2" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PEV_BUFF3_DESC" /><input class="sheet-buff" type="number" name="attr_PEV_BUFF3" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PEV_BUFF4_DESC" /><input class="sheet-buff" type="number" name="attr_PEV_BUFF4" />
            </td>
            <td style="width: 19%;">
              <input class="sheet-buff" style="width: 70%;" type="text" name="attr_PEV_BUFF5_DESC" /><input class="sheet-buff" type="number" name="attr_PEV_BUFF5" />
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
  <div class="sheet-tab-content sheet-fp3">
    <input type="radio" name="attr_tab_pnj" class="sheet-tab sheet-tab1" value="caracs" checked="checked"><span title="Caractéristiques"></span>
    <input type="radio" name="attr_tab_pnj" class="sheet-tab sheet-tab2" value="config"><span title="Configuration"></span>
    <img class="sheet-imghr-up" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
    <div class="sheet-tab-content sheet-tab1">
      <diV>
        <div class="sheet-2colrow">
          <div class="sheet-col">
            <div class="sheet-row">
              <span class="textfatleft">Attributs</span>
            </div>
            <div class="sheet-3colrow">
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_for" title="Jet de Force" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Force}} {{subtags=Test}} {{carac=[[@{pnj_jetfor}cs20cf1[Dé] + [[@{pnj_for}]][FOR] ]] }}"> FOR</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_for" type="number" title="@{pnj_for}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetfor" title="@{pnj_jetfor}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_dex" title="Jet de Dextérité" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Dextérité}} {{subtags=Test}} {{carac=[[@{pnj_jetdex}cs20cf1[Dé] + [[@{pnj_dex}]][DEX] ]] }}"> DEX</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_dex" type="number" title="@{pnj_dex}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetdex" title="@{pnj_jetdex}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_con" title="Jet de Constitution" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Constitution}} {{subtags=Test}} {{carac=[[@{pnj_jetcon}cs20cf1[Dé] + [[@{pnj_con}]][CON] ]] }}"> CON</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_con" type="number" title="@{pnj_con}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetcon" title="@{pnj_jetcon}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="sheet-row">&nbsp;</div>
            <div class="sheet-3colrow">
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_int" title="Jet d'Intelligence" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Intelligence}} {{subtags=Test}} {{carac=[[@{pnj_jetint}cs20cf1[Dé] + [[@{pnj_int}]][INT] ]] }}"> INT</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_int" type="number" title="@{pnj_int}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetint" title="@{pnj_jetint}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_per" title="Jet de Perception" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Perception}} {{subtags=Test}} {{carac=[[@{pnj_jetper}cs20cf1[Dé] + [[@{pnj_per}]][PER] ]] }}"> PER</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_per" type="number" title="@{pnj_per}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetper" title="@{pnj_jetper}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_cha" title="Jet de Charisme" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Charisme}} {{subtags=Test}} {{carac=[[@{pnj_jetcha}cs20cf1[Dé] + [[@{pnj_cha}]][CHA] ]] }}"> CHA</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_cha" type="number" title="@{pnj_cha}" />
                  <select class="sheet-carac" style="width: 30px;" name="attr_pnj_jetcha" title="@{pnj_jetcha}">
                    <option value="1d20" selected>N - Normale</option>
                    <option value="2d20kh1">S - Supérieure</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="sheet-row">&nbsp;</div>
            <div class="sheet-3colrow">
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre"><button class="sheet-boxtitre" type="roll" name="jet_pnj_init" title="Jet d'Initiative" value="@(pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=Initiative}} {{subtags=Combat}} {{carac=[[@{pnj_init}[Init.] + @{pnj_init_var}[Dé(s)] &{tracker}]]}}"> Init.</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_init" type="number" title="@{pnj_init}" />
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre">DEF</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_def" type="number" title="@{pnj_def}" />
                </div>
              </div>
              <div class="sheet-col" style="width: 25%;">
                <div class="sheet-boxtitre">PV</div>
                <div class="sheet-boxinput">
                  <input class="sheet-carac" name="attr_pnj_pv" type="number" title="@{pnj_pv} PV courants" /> / <input class="sheet-carac" name="attr_pnj_pv_max" type="number" title="@{pnj_pv|max} PV MAX" />
                </div>
              </div>
            </div>
            <div class="sheet-row">
              <span class="textfatleft" title="repeating_pnjatk">Attaques</span>
            </div>
            <div class="sheet-row">
              <fieldset class="repeating_pnjatk">
                <table class="sheet-tabsep">
                  <tr>
                    <td>
                      <button type="roll" class="sheet-neutre" style="width: 25px;" name="attr_jet" value="@{pnj_togm}&{template:co1} {{perso=@{character_name}}} {{name=@{atknom}}} {{subtags=Attaque}} @{atkatt}[[@{atkjet}[Dé] + [[@{atkbonus}]][Attaque] ]]}} @{atkdmg}[[@{atkdmnbde}d@{atkdmde}[Dé DM] + [[@{atkdmbonus}]][Mod.DM] ]]}} {{special=@{atkspec}}}" />
                    </td>
                    <td class="sheet-boxinputleft" style="min-width: 170px;">
                      <input type="text" class="sheet-carac" style="width: 120px;" name="attr_atknom" title="@{atknom} Nom de l'arme / attaque" />
                      <input type="checkbox" name="attr_atkatt" title="@{atkatt} Faire un jet d'attaque pour toucher" value="{{attaque=" checked="checked" />
                      <select class="sheet-selectmin" name="attr_atkjet" title="@{atkjet} Jet d'attaque normal (d20) ou expert (meilleur de deux d20)">
                        <option value="1d20" selected>N Normal</option>
                        <option value="2d20kh1">E Expert</option>
                      </select>
                      <input type="number" class="sheet-carac" style="width: 35px;" name="attr_atkbonus" title="@{atkbonus} Bonus d'attaque" value="0" />
                    </td>
                    <td class="sheet-boxinput">
                      <input type="checkbox" name="attr_atkdmg" title="@{atkdmg} Faire un jet de dommages" value="{{degats=" checked="checked" />
                      <input type="number" name="attr_atkdmnbde" style="width: 35px;" title="@{atkdmnbde} Nombre de dés de DM" />
                      <select class="sheet-carac" style="width: 45px;" name="attr_atkdmde" title="@{atkdmde} Dé de DM">
                        <optgroup label="Normaux">
                          <option value="3">d3</option>
                          <option value="4">d4</option>
                          <option value="6">d6</option>
                          <option value="8">d8</option>
                          <option value="10">d10</option>
                          <option value="12">d12</option>
                        </optgroup>
                        <optgroup label="Sans limite">
                          <option value="3!">d3</option>
                          <option value="4!">d4</option>
                          <option value="6!" selected>d6</option>
                          <option value="8!">d8</option>
                          <option value="10!">d10</option>
                          <option value="12!">d12</option>
                        </optgroup>
                      </select>
                      + <input type="number" name="attr_atkdmbonus" style="width: 35px;" title="@{atkdmbonus} Bonus aux DM" value="0" />
                    </td>
                  </tr>
                  <tr>
                    <td class="sheet-boxinput" colspan="3">
                      <textarea class="sheet-carac" name="attr_atkspec" title="@{atkspec} Autres effets"></textarea>
                    </td>
                  </tr>
                </table>
              </fieldset>
            </div>
          </div>
          <div class="sheet-col">
            <div class="sheet-row">
              <span class="textfatleft">Capacités</span>
            </div>
            <div class="sheet-row">
              <textarea name="attr_pnj_divers" style="height: 15em;"></textarea>
            </div>
            <div class="sheet-row">
			  <input type="checkbox" class="sheet-block-switch"><span>Importer statblock</span>
			  <div class="sheet-block-hidden"></div>
			  <div class="sheet-block-show">
	            <textarea class="sheet-boxinputleft" name="attr_statblock" style="height: 10em;" placeholder="Coller ici un statblock copié depuis le PDF"></textarea>
	            &nbsp;
	            <textarea name="attr_sbresult" style="border: 1px solid; height: 5em;"></textarea>
	          </div>
            </div>
          </div>
        </div>
      </diV>
    </div>
    <div class="sheet-tab-content sheet-tab2">
      <div class="sheet-3colrow">
        <div class="sheet-col">
          <span class="textbase">Jets</span>&nbsp;
          <select class="sheet-carac" style="width: 75px;" name="attr_pnj_togm" title="@{pnj_togm}" size="1">
            <option value="" selected>Normaux</option>
            <option value="/w gm ">Cachés</option>
          </select>
        </div>
        <div class="sheet-col">
          <span class="textbase">Initiative variable</span>&nbsp;<input type="checkbox" name="attr_pnj_init_var" title="@{pnj_init_var}" value="[[1d6!]]" />
        </div>
      </div>
      <div class="sheet-col"></div>
    </div>
  </div>
</div> <!-- FIN FDP -->
<!-- TEMPLATES -->
<rolltemplate class="sheet-rolltemplate-co1">
  <div class="sheet-roundtable">
    <table>
      <tr>
        <th colspan="2" style="text-align: center;">{{perso}}</th>
      </tr>
      <tr>
        <td class="subheader">{{subtags}}</td>
        <th>{{name}}</th>
      </tr>
      {{#portee}}
        <tr>
          <td style="font-size: smaller; text-align: center;" colspan="2">Portée : {{portee}}</td>
        </tr>
      {{/portee}}
      <tr>
        <td colspan="2">
          <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
        </td>
      </tr>
      {{#desc}}
        <tr>
          <td colspan="2" style="white-space:normal;">
            <div class="desc">{{desc}}</div>
          </td>
        </tr>
      {{/desc}}
      {{#DV}}
        <tr>
          <td class="tcat">PV gagnés</td>
          <td>{{DV}}</td>
        </tr>
      {{/DV}}
      {{#RECUP}}
        <tr>
          <td class="tcat">PV récupérés</td>
          <td>{{RECUP}}</td>
        </tr>
      {{/RECUP}}
      {{#carac}}
        <tr>
          <td class="tcat">Jet </td>
          <td>{{carac}}</td>
        </tr>
      {{/carac}}
      {{#test}}
        <tr>
          <td colspan="2">{{test}}</td>
        </tr>
        {{#rollWasCrit() test}}
          <tr>
            <td colspan="2" style="color:green;">
              <div class="desc"><b>{{test_crit}}</b></div>
            </td>
          </tr>
        {{/rollWasCrit() test}}
        {{#rollWasFumble() test}}
          <tr>
            <td colspan="2" style="color:red;">
              <div class="desc"><b>{{test_fumble}}</b></div>
            </td>
          </tr>
        {{/rollWasFumble() test}}
      {{/test}}
      {{#attaque}}
        {{#rollWasCrit() attaque}}
          <tr>
            <td colspan="2" style="color:green;"><b>Critique !</b></td>
          </tr>
        {{/rollWasCrit() attaque}}
        {{#rollWasFumble() attaque}}
          <tr>
            <td colspan="2" style="color:red;"><b>Fumble !</b></td>
          </tr>
        {{/rollWasFumble() attaque}}
        <tr>
          <td class="tcat">Jet </td>
          <td>{{attaque}}</td>
        </tr>
        {{#degats}}
          <tr>
            <td colspan="2">&nbsp;</td>
          </tr>
          <tr>
            <td class="tcat">Dégâts </td>
            <td>
              {{degats}}
              {{#rollWasCrit() attaque}}
                <span style="color:green;font-weight:bold;"> + {{degats}}</span>
              {{/rollWasCrit() attaque}}
            </td>
          </tr>
        {{/degats}}
      {{/attaque}}
      {{^attaque}}
          {{#degats}}
              <tr>
                  <td class="tcat">Dégâts </td>
                  <td>{{degats}}</td>
              </tr>
          {{/degats}}
      {{/attaque}}
      {{#special}}
        <tr>
          <td colspan="2" class="subheader" style="text-align:left;">Spécial</td>
        </tr>
        <tr>
          <td colspan="2" style="white-space:normal;">
            <div class="desc">{{special}}</div>
          </td>
        </tr>
      {{/special}}
      {{#text}}
        <tr>
          <td colspan="2" style="white-space:normal; margin: 1px;">
            <div class="text">{{text}}</div>
          </td>
        </tr>
      {{/text}}
      <tr>
        <td colspan="2">
          <img class="sheet-imghr" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/ChroniquesGalactiques/cog_hr.png" />
        </td>
      </tr>
    </table>
  </div>
</rolltemplate>
<!-- FIN TEMPLATES -->
